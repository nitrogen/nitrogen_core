<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
               "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<title>Introduction to Nitrogen</title>
<meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1"/>
<meta name="title" content="Introduction to Nitrogen"/>
<meta name="generator" content="Org-mode"/>
<meta name="generated" content="2012-10-18 03:24:02 CDT"/>
<meta name="author" content="Jesse Gumm"/>
<meta name="description" content=""/>
<meta name="keywords" content=""/>
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  html { font-family: Times, serif; font-size: 12pt; }
  .title  { text-align: center; }
  .todo   { color: red; }
  .done   { color: green; }
  .tag    { background-color: #add8e6; font-weight:normal }
  .target { }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .right  {margin-left:auto; margin-right:0px;  text-align:right;}
  .left   {margin-left:0px;  margin-right:auto; text-align:left;}
  .center {margin-left:auto; margin-right:auto; text-align:center;}
  p.verse { margin-left: 3% }
  pre {
	border: 1pt solid #AEBDCC;
	background-color: #F3F5F7;
	padding: 5pt;
	font-family: courier, monospace;
        font-size: 90%;
        overflow:auto;
  }
  table { border-collapse: collapse; }
  td, th { vertical-align: top;  }
  th.right  { text-align:center;  }
  th.left   { text-align:center;   }
  th.center { text-align:center; }
  td.right  { text-align:right;  }
  td.left   { text-align:left;   }
  td.center { text-align:center; }
  dt { font-weight: bold; }
  div.figure { padding: 0.5em; }
  div.figure p { text-align: center; }
  div.inlinetask {
    padding:10px;
    border:2px solid gray;
    margin:10px;
    background: #ffffcc;
  }
  textarea { overflow-x: auto; }
  .linenr { font-size:smaller }
  .code-highlighted {background-color:#ffff00;}
  .org-info-js_info-navigation { border-style:none; }
  #org-info-js_console-label { font-size:10px; font-weight:bold;
                               white-space:nowrap; }
  .org-info-js_search-highlight {background-color:#ffff00; color:#000000;
                                 font-weight:bold; }
  /*]]>*/-->
</style>
<link rel="stylesheet" href="tutorial.css" />
<script type="text/javascript">
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>

</head>
<body>

<div id="preamble">

</div>

<div id="content">
<h1 class="title">Introduction to Nitrogen</h1>


<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#sec-1">1 Welcome</a></li>
<li><a href="#sec-2">2 Main Agenda Slide</a>
<ul>
<li><a href="#sec-2-1">2.1 Agenda</a></li>
</ul>
</li>
<li><a href="#sec-3">3 PART 1 AGENDA</a>
<ul>
<li><a href="#sec-3-1">3.1 Install &amp; Run Nitrogen</a></li>
</ul>
</li>
<li><a href="#sec-4">4 Install Nitrogen</a>
<ul>
<li><a href="#sec-4-1">4.1 Install Nitrogen</a>
<ul>
<li><a href="#sec-4-1-1">4.1.1 If you <b>don't</b> have Erlang Installed:</a></li>
<li><a href="#sec-4-1-2">4.1.2 If you <b>do</b> have Erlang installed:</a></li>
</ul></li>
</ul>
</li>
<li><a href="#sec-5">5 Start the Website in Console Mode</a>
<ul>
<li><a href="#sec-5-1">5.1 Install &amp; Run Nitrogen</a>
<ul>
<li><a href="#sec-5-1-1">5.1.1 Start Up</a></li>
</ul></li>
</ul>
</li>
<li><a href="#sec-6">6 Stop the Website</a>
<ul>
<li><a href="#sec-6-1">6.1 Install &amp; Run Nitrogen</a>
<ul>
<li><a href="#sec-6-1-1">6.1.1 Shut Down</a></li>
<li><a href="#sec-6-1-2">6.1.2 View the Directory</a></li>
</ul></li>
</ul>
</li>
<li><a href="#sec-7">7 Anatomy of a Nitrogen Project</a>
<ul>
<li><a href="#sec-7-1">7.1 Install &amp; Run Nitrogen</a>
<ul>
<li><a href="#sec-7-1-1">7.1.1 Anatomy of a Nitrogen Project</a></li>
</ul></li>
</ul>
</li>
<li><a href="#sec-8">8 Anatomy of the site/ Directory</a>
<ul>
<li><a href="#sec-8-1">8.1 Install &amp; Run Nitrogen</a>
<ul>
<li><a href="#sec-8-1-1">8.1.1 The <code>site/</code> Directory</a></li>
</ul></li>
</ul>
</li>
<li><a href="#sec-9">9 Anatomy of the site/src Directory</a>
<ul>
<li><a href="#sec-9-1">9.1 Install &amp; Run Nitrogen</a>
<ul>
<li><a href="#sec-9-1-1">9.1.1 The <code>site/src/</code> Directory</a></li>
</ul></li>
</ul>
</li>
<li><a href="#sec-10">10 Exercise: Modify a Nitrogen Page</a>
<ul>
<li><a href="#sec-10-1">10.1 Install &amp; Run Nitrogen</a>
<ul>
<li><a href="#sec-10-1-1">10.1.1 Exercise: Modify Your First Page</a></li>
</ul></li>
</ul>
</li>
<li><a href="#sec-11">11 Exercise: Compile in Different Ways</a>
<ul>
<li><a href="#sec-11-1">11.1 Install &amp; Run Nitrogen</a>
<ul>
<li><a href="#sec-11-1-1">11.1.1 Exercise: Compile in a Different Way</a></li>
</ul></li>
</ul>
</li>
<li><a href="#sec-12">12 Dynamic Compiling</a>
<ul>
<li><a href="#sec-12-1">12.1 Install &amp; Run Nitrogen</a>
<ul>
<li><a href="#sec-12-1-1">12.1.1 Understanding <code>sync</code></a></li>
</ul></li>
</ul>
</li>
<li><a href="#sec-13">13 Exercise: Debugging</a>
<ul>
<li><a href="#sec-13-1">13.1 Install &amp; Run Nitrogen</a>
<ul>
<li><a href="#sec-13-1-1">13.1.1 Debug Statements</a></li>
</ul></li>
</ul>
</li>
<li><a href="#sec-14">14 Emacs Mode</a>
<ul>
<li><a href="#sec-14-1">14.1 Install &amp; Run Nitrogen</a>
<ul>
<li><a href="#sec-14-1-1">14.1.1 Emacs <code>nitrogen-mode</code></a></li>
</ul></li>
</ul>
</li>
<li><a href="#sec-15">15 PART 2 AGENDA</a>
<ul>
<li><a href="#sec-15-1">15.1 Nitrogen Pages</a></li>
</ul>
</li>
<li><a href="#sec-16">16 What is a Nitrogen Page?</a>
<ul>
<li><a href="#sec-16-1">16.1 Nitrogen Pages</a>
<ul>
<li><a href="#sec-16-1-1">16.1.1 What is a Nitrogen Page</a></li>
</ul></li>
</ul>
</li>
<li><a href="#sec-17">17 Dynamic Routes Explained</a>
<ul>
<li><a href="#sec-17-1">17.1 Nitrogen Pages</a>
<ul>
<li><a href="#sec-17-1-1">17.1.1 Dynamic Routing Explained</a></li>
</ul></li>
</ul>
</li>
<li><a href="#sec-18">18 Creating a New Page</a>
<ul>
<li><a href="#sec-18-1">18.1 Nitrogen Pages</a>
<ul>
<li><a href="#sec-18-1-1">18.1.1 Exercise: Create a New Page</a></li>
</ul></li>
</ul>
</li>
<li><a href="#sec-19">19 How is a Page Rendered (Simple Version)</a>
<ul>
<li><a href="#sec-19-1">19.1 Nitrogen Pages</a>
<ul>
<li><a href="#sec-19-1-1">19.1.1 How is a Page Rendered?</a></li>
</ul></li>
</ul>
</li>
<li><a href="#sec-20">20 Anatomy of a Template</a>
<ul>
<li><a href="#sec-20-1">20.1 Nitrogen Pages</a>
<ul>
<li><a href="#sec-20-1-1">20.1.1 Anatomy of a Template</a></li>
</ul></li>
</ul>
</li>
<li><a href="#sec-21">21 Experimenting With Templates</a>
<ul>
<li><a href="#sec-21-1">21.1 Nitrogen Pages</a>
<ul>
<li><a href="#sec-21-1-1">21.1.1 Experimenting With Templates</a></li>
</ul></li>
</ul>
</li>
<li><a href="#sec-22">22 PART 3 AGENDA</a>
<ul>
<li><a href="#sec-22-1">22.1 Nitrogen Elements</a></li>
</ul>
</li>
<li><a href="#sec-23">23 What is a Nitrogen Element?</a>
<ul>
<li><a href="#sec-23-1">23.1 Nitrogen Elements</a>
<ul>
<li><a href="#sec-23-1-1">23.1.1 What is a Nitrogen Element?</a></li>
</ul></li>
</ul>
</li>
<li><a href="#sec-24">24 What is a Nitrogen Element?</a>
<ul>
<li><a href="#sec-24-1">24.1 Nitrogen Elements</a>
<ul>
<li><a href="#sec-24-1-1">24.1.1 What is a Nitrogen Element?</a></li>
</ul></li>
</ul>
</li>
<li><a href="#sec-25">25 Nitrogen Element Properties</a>
<ul>
<li><a href="#sec-25-1">25.1 Nitrogen Elements</a>
<ul>
<li><a href="#sec-25-1-1">25.1.1 Why Nitrogen Elements?</a></li>
</ul></li>
</ul>
</li>
<li><a href="#sec-26">26 Nitrogen Element Examples</a>
<ul>
<li><a href="#sec-26-1">26.1 Nitrogen Elements</a>
<ul>
<li><a href="#sec-26-1-1">26.1.1 Nitrogen Element Examples</a></li>
</ul></li>
</ul>
</li>
<li><a href="#sec-27">27 Nested Elements</a>
<ul>
<li><a href="#sec-27-1">27.1 Nitrogen Elements</a>
<ul>
<li><a href="#sec-27-1-1">27.1.1 Nested Elements</a></li>
</ul></li>
</ul>
</li>
<li><a href="#sec-28">28 PART 4 AGENDA</a>
<ul>
<li><a href="#sec-28-1">28.1 Nitrogen Actions</a></li>
</ul>
</li>
<li><a href="#sec-29">29 What is a Nitrogen Action?</a>
<ul>
<li><a href="#sec-29-1">29.1 Nitrogen Actions</a>
<ul>
<li><a href="#sec-29-1-1">29.1.1 What is a Nitrogen Action?</a></li>
</ul></li>
</ul>
</li>
<li><a href="#sec-30">30 What is a Nitrogen Action?</a>
<ul>
<li><a href="#sec-30-1">30.1 Nitrogen Actions</a>
<ul>
<li><a href="#sec-30-1-1">30.1.1 What is a Nitrogen Action?</a></li>
</ul></li>
</ul>
</li>
<li><a href="#sec-31">31 Wiring an Action</a>
<ul>
<li><a href="#sec-31-1">31.1 Nitrogen Actions</a>
<ul>
<li><a href="#sec-31-1-1">31.1.1 Wiring an Action</a></li>
</ul></li>
</ul>
</li>
<li><a href="#sec-32">32 Conditional Actions with <code>#event{}</code></a>
<ul>
<li><a href="#sec-32-1">32.1 Nitrogen Actions</a>
<ul>
<li><a href="#sec-32-1-1">32.1.1 Conditional Actions with <code>#event{}</code></a></li>
</ul></li>
</ul>
</li>
<li><a href="#sec-33">33 Triggers and Targets</a>
<ul>
<li><a href="#sec-33-1">33.1 Nitrogen Actions</a>
<ul>
<li><a href="#sec-33-1-1">33.1.1 Triggers and Targets</a></li>
</ul></li>
</ul>
</li>
<li><a href="#sec-34">34 Triggers and Targets</a>
<ul>
<li><a href="#sec-34-1">34.1 Nitrogen Actions</a>
<ul>
<li><a href="#sec-34-1-1">34.1.1 Triggers and Targets</a></li>
</ul></li>
</ul>
</li>
<li><a href="#sec-35">35 Quick Review</a>
<ul>
<li><a href="#sec-35-1">35.1 Nitrogen Actions</a>
<ul>
<li><a href="#sec-35-1-1">35.1.1 Quick Review</a></li>
</ul></li>
</ul>
</li>
<li><a href="#sec-36">36 PART 5 AGENDA</a>
<ul>
<li><a href="#sec-36-1">36.1 Nitrogen Events</a></li>
</ul>
</li>
<li><a href="#sec-37">37 What is a Postback?</a>
<ul>
<li><a href="#sec-37-1">37.1 Nitrogen Events</a>
<ul>
<li><a href="#sec-37-1-1">37.1.1 What is a Postback?</a></li>
</ul></li>
</ul>
</li>
<li><a href="#sec-38">38 Your First Postback</a>
<ul>
<li><a href="#sec-38-1">38.1 Nitrogen Events</a>
<ul>
<li><a href="#sec-38-1-1">38.1.1 Your First Postback</a></li>
</ul></li>
</ul>
</li>
<li><a href="#sec-39">39 Postback Shortcuts</a>
<ul>
<li><a href="#sec-39-1">39.1 Nitrogen Events</a>
<ul>
<li><a href="#sec-39-1-1">39.1.1 Postback Shortcuts</a></li>
</ul></li>
</ul>
</li>
<li><a href="#sec-40">40 Postback Shortcuts</a>
<ul>
<li><a href="#sec-40-1">40.1 Nitrogen Events</a>
<ul>
<li><a href="#sec-40-1-1">40.1.1 Postback Shortcuts</a></li>
</ul></li>
</ul>
</li>
<li><a href="#sec-41">41 More Event Examples</a>
<ul>
<li><a href="#sec-41-1">41.1 Nitrogen Events</a>
<ul>
<li><a href="#sec-41-1-1">41.1.1 More Event Examples</a></li>
</ul></li>
</ul>
</li>
<li><a href="#sec-42">42 More Event Examples</a>
<ul>
<li><a href="#sec-42-1">42.1 Nitrogen Events</a>
<ul>
<li><a href="#sec-42-1-1">42.1.1 More Event Examples</a></li>
</ul></li>
</ul>
</li>
<li><a href="#sec-43">43 Modifying Elements</a>
<ul>
<li><a href="#sec-43-1">43.1 Nitrogen Events</a>
<ul>
<li><a href="#sec-43-1-1">43.1.1 Modifying Elements</a></li>
</ul></li>
</ul>
</li>
<li><a href="#sec-44">44 More Page Manipulation</a>
<ul>
<li><a href="#sec-44-1">44.1 Nitrogen Events</a>
<ul>
<li><a href="#sec-44-1-1">44.1.1 More Page Manipulation</a></li>
</ul></li>
</ul>
</li>
<li><a href="#sec-45">45 PART 6 AGENDA</a>
<ul>
<li><a href="#sec-45-1">45.1 Remembering State</a></li>
</ul>
</li>
<li><a href="#sec-46">46 Page State vs. Session State</a>
<ul>
<li><a href="#sec-46-1">46.1 Remembering State</a>
<ul>
<li><a href="#sec-46-1-1">46.1.1 Page State vs. Session State</a></li>
</ul></li>
</ul>
</li>
<li><a href="#sec-47">47 Page State</a>
<ul>
<li><a href="#sec-47-1">47.1 Remembering State</a>
<ul>
<li><a href="#sec-47-1-1">47.1.1 Page State</a></li>
</ul></li>
</ul>
</li>
<li><a href="#sec-48">48 Page State</a>
<ul>
<li><a href="#sec-48-1">48.1 Remembering State</a>
<ul>
<li><a href="#sec-48-1-1">48.1.1 Page State</a></li>
</ul></li>
</ul>
</li>
<li><a href="#sec-49">49 Session State</a>
<ul>
<li><a href="#sec-49-1">49.1 Remembering State</a>
<ul>
<li><a href="#sec-49-1-1">49.1.1 Session State</a></li>
</ul></li>
</ul>
</li>
<li><a href="#sec-50">50 Session State</a>
<ul>
<li><a href="#sec-50-1">50.1 Remembering State</a>
<ul>
<li><a href="#sec-50-1-1">50.1.1 Session State</a></li>
</ul></li>
</ul>
</li>
<li><a href="#sec-51">51 PART 7 AGENDA</a>
<ul>
<li><a href="#sec-51-1">51.1 Security</a></li>
</ul>
</li>
<li><a href="#sec-52">52 Limiting Access to a Page</a>
<ul>
<li><a href="#sec-52-1">52.1 Security</a>
<ul>
<li><a href="#sec-52-1-1">52.1.1 Limiting Access to a Page</a></li>
</ul></li>
</ul>
</li>
<li><a href="#sec-53">53 Authentication and Authorization Functions</a>
<ul>
<li><a href="#sec-53-1">53.1 Security</a>
<ul>
<li><a href="#sec-53-1-1">53.1.1 Authentication and Authorization Functions</a></li>
</ul></li>
</ul>
</li>
<li><a href="#sec-54">54 Page Redirection Functions</a>
<ul>
<li><a href="#sec-54-1">54.1 Security</a>
<ul>
<li><a href="#sec-54-1-1">54.1.1 Page Redirection Functions</a></li>
</ul></li>
</ul>
</li>
<li><a href="#sec-55">55 Creating a Secure Page - Step 1</a>
<ul>
<li><a href="#sec-55-1">55.1 Security</a>
<ul>
<li><a href="#sec-55-1-1">55.1.1 Creating a Secure Page - Step 1</a></li>
</ul></li>
</ul>
</li>
<li><a href="#sec-56">56 Creating a Secure Page - Step 2</a>
<ul>
<li><a href="#sec-56-1">56.1 Security</a>
<ul>
<li><a href="#sec-56-1-1">56.1.1 Creating a Secure Page - Step 2</a></li>
</ul></li>
</ul>
</li>
<li><a href="#sec-57">57 Creating a Secure Page - Step 3</a>
<ul>
<li><a href="#sec-57-1">57.1 Security</a>
<ul>
<li><a href="#sec-57-1-1">57.1.1 Creating a Secure Page - Step 3</a></li>
</ul></li>
</ul>
</li>
<li><a href="#sec-58">58 Creating a Secure Page - Step 4</a>
<ul>
<li><a href="#sec-58-1">58.1 Security</a>
<ul>
<li><a href="#sec-58-1-1">58.1.1 Creating a Secure Page - Step 4</a></li>
</ul></li>
</ul>
</li>
<li><a href="#sec-59">59 PART 8 AGENDA</a>
<ul>
<li><a href="#sec-59-1">59.1 Validation</a></li>
</ul>
</li>
<li><a href="#sec-60">60 Overview of Nitrogen Validation</a>
<ul>
<li><a href="#sec-60-1">60.1 Validation</a>
<ul>
<li><a href="#sec-60-1-1">60.1.1 Overview of Nitrogen Validation</a></li>
</ul></li>
</ul>
</li>
<li><a href="#sec-61">61 Overview of Nitrogen Validation</a>
<ul>
<li><a href="#sec-61-1">61.1 Validation</a>
<ul>
<li><a href="#sec-61-1-1">61.1.1 Overview of Nitrogen Validation</a></li>
</ul></li>
</ul>
</li>
<li><a href="#sec-62">62 Overview of Nitrogen Validation</a>
<ul>
<li><a href="#sec-62-1">62.1 Validation</a>
<ul>
<li><a href="#sec-62-1-1">62.1.1 Overview of Nitrogen Validation</a></li>
</ul></li>
</ul>
</li>
<li><a href="#sec-63">63 Overview of Nitrogen Validation</a>
<ul>
<li><a href="#sec-63-1">63.1 Validation</a>
<ul>
<li><a href="#sec-63-1-1">63.1.1 Overview of Nitrogen Validation</a></li>
</ul></li>
</ul>
</li>
<li><a href="#sec-64">64 PART 9 AGENDA</a>
<ul>
<li><a href="#sec-64-1">64.1 Comet</a></li>
</ul>
</li>
<li><a href="#sec-65">65 What is Comet?</a>
<ul>
<li><a href="#sec-65-1">65.1 Comet</a>
<ul>
<li><a href="#sec-65-1-1">65.1.1 What is Comet?</a></li>
</ul></li>
</ul>
</li>
<li><a href="#sec-66">66 Comet the Nitrogen/Erlang Way</a>
<ul>
<li><a href="#sec-66-1">66.1 Comet</a>
<ul>
<li><a href="#sec-66-1-1">66.1.1 Comet the Nitrogen/Erlang Way</a></li>
</ul></li>
</ul>
</li>
<li><a href="#sec-67">67 A Comet Counter</a>
<ul>
<li><a href="#sec-67-1">67.1 Comet</a>
<ul>
<li><a href="#sec-67-1-1">67.1.1 A Comet Counter</a></li>
</ul></li>
</ul>
</li>
<li><a href="#sec-68">68 Comet Pools</a>
<ul>
<li><a href="#sec-68-1">68.1 Comet</a>
<ul>
<li><a href="#sec-68-1-1">68.1.1 Comet Pools</a></li>
</ul></li>
</ul>
</li>
<li><a href="#sec-69">69 Comet Pool Scope</a>
<ul>
<li><a href="#sec-69-1">69.1 Comet</a>
<ul>
<li><a href="#sec-69-1-1">69.1.1 Comet Pool Scope</a></li>
</ul></li>
</ul>
</li>
<li><a href="#sec-70">70 The Simplest Chatroom Ever Constructed</a>
<ul>
<li><a href="#sec-70-1">70.1 Comet</a>
<ul>
<li><a href="#sec-70-1-1">70.1.1 The Simplest Chatroom Ever Constructed</a></li>
</ul></li>
</ul>
</li>
<li><a href="#sec-71">71 PART 10 AGENDA</a>
<ul>
<li><a href="#sec-71-1">71.1 Extending Nitrogen</a></li>
</ul>
</li>
<li><a href="#sec-72">72 Custom Elements - Part 1</a>
<ul>
<li><a href="#sec-72-1">72.1 Extending Nitrogen</a>
<ul>
<li><a href="#sec-72-1-1">72.1.1 Custom Elements - Part 1</a></li>
</ul></li>
</ul>
</li>
<li><a href="#sec-73">73 Custom Elements - Part 2</a>
<ul>
<li><a href="#sec-73-1">73.1 Extending Nitrogen</a>
<ul>
<li><a href="#sec-73-1-1">73.1.1 Custom Elements - Part 2</a></li>
</ul></li>
</ul>
</li>
<li><a href="#sec-74">74 Custom Elements - Part 3</a>
<ul>
<li><a href="#sec-74-1">74.1 Extending Nitrogen</a>
<ul>
<li><a href="#sec-74-1-1">74.1.1 Custom Elements - Part 3</a></li>
</ul></li>
</ul>
</li>
<li><a href="#sec-75">75 Custom Elements - Part 4</a>
<ul>
<li><a href="#sec-75-1">75.1 Extending Nitrogen</a>
<ul>
<li><a href="#sec-75-1-1">75.1.1 Custom Elements - Part 4</a></li>
</ul></li>
</ul>
</li>
<li><a href="#sec-76">76 Custom Actions - Part 1</a>
<ul>
<li><a href="#sec-76-1">76.1 Extending Nitrogen</a>
<ul>
<li><a href="#sec-76-1-1">76.1.1 Custom Actions - Part 1</a></li>
</ul></li>
</ul>
</li>
<li><a href="#sec-77">77 Custom Actions - Part 2</a>
<ul>
<li><a href="#sec-77-1">77.1 Extending Nitrogen</a>
<ul>
<li><a href="#sec-77-1-1">77.1.1 Custom Actions - Part 2</a></li>
</ul></li>
</ul>
</li>
<li><a href="#sec-78">78 Custom Actions - Part 3</a>
<ul>
<li><a href="#sec-78-1">78.1 Extending Nitrogen</a>
<ul>
<li><a href="#sec-78-1-1">78.1.1 Custom Actions - Part 3</a></li>
</ul></li>
</ul>
</li>
<li><a href="#sec-79">79 Handlers - Part 1</a>
<ul>
<li><a href="#sec-79-1">79.1 Extending Nitrogen</a>
<ul>
<li><a href="#sec-79-1-1">79.1.1 Handlers - Part 1</a></li>
</ul></li>
</ul>
</li>
<li><a href="#sec-80">80 Handlers - Part 2</a>
<ul>
<li><a href="#sec-80-1">80.1 Extending Nitrogen</a>
<ul>
<li><a href="#sec-80-1-1">80.1.1 Handlers - Part 2</a></li>
</ul></li>
</ul>
</li>
<li><a href="#sec-81">81 Handlers - Part 3</a>
<ul>
<li><a href="#sec-81-1">81.1 Extending Nitrogen</a>
<ul>
<li><a href="#sec-81-1-1">81.1.1 Handlers - Part 3</a></li>
</ul></li>
</ul>
</li>
<li><a href="#sec-82">82 Handlers - Part 3</a>
<ul>
<li><a href="#sec-82-1">82.1 Extending Nitrogen</a>
<ul>
<li><a href="#sec-82-1-1">82.1.1 Handlers - Part 3</a></li>
</ul></li>
</ul>
</li>
<li><a href="#sec-83">83 Conclusion</a>
<ul>
<li><a href="#sec-83-1">83.1 Conclusion</a></li>
</ul>
</li>
<li><a href="#sec-84">84 Conclusion</a>
<ul>
<li><a href="#sec-84-1">84.1 Thanks</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-1" class="outline-2">
<h2 id="sec-1"><span class="section-number-2">1</span> Welcome</h2>
<div class="outline-text-2" id="text-1">


<div style="text-align:center; font-size: 400%; line-height: 1em;">
<br>
Introduction to Nitrogen
<hr>
</div>
<div style="text-align:center; font-size: 100%; line-height: 1.5em;">
A step-by-step introduction to the<br>
major features and concepts behind<br>
the Nitrogen Web Framework.
</div>

</div>

</div>

<div id="outline-container-2" class="outline-2">
<h2 id="sec-2"><span class="section-number-2">2</span> Main Agenda Slide</h2>
<div class="outline-text-2" id="text-2">


</div>

<div id="outline-container-2-1" class="outline-3">
<h3 id="sec-2-1"><span class="section-number-3">2.1</span> Agenda</h3>
<div class="outline-text-3" id="text-2-1">

<ul>
<li>Part 1: Install &amp; Run Nitrogen
</li>
<li>Part 2: Nitrogen Pages
</li>
<li>Part 3: Nitrogen Elements
</li>
<li>Part 4: Nitrogen Actions
</li>
<li>Part 5: Nitrogen Postback Events
</li>
<li>Part 6: Session and Page State
</li>
<li>Part 7: Security
</li>
<li>Part 8: Validation
</li>
<li>Part 9: Comet
</li>
<li>Part 10: Extending Nitrogen
</li>
<li>Conclusion
</li>
</ul>


</div>
</div>

</div>

<div id="outline-container-3" class="outline-2">
<h2 id="sec-3"><span class="section-number-2">3</span> PART 1 AGENDA</h2>
<div class="outline-text-2" id="text-3">


</div>

<div id="outline-container-3-1" class="outline-3">
<h3 id="sec-3-1"><span class="section-number-3">3.1</span> Install &amp; Run Nitrogen</h3>
<div class="outline-text-3" id="text-3-1">


<ul>
<li>Install Nitrogen
</li>
<li>Run the Website
</li>
<li>A Tour Through the Files
</li>
</ul>


</div>
</div>

</div>

<div id="outline-container-4" class="outline-2">
<h2 id="sec-4"><span class="section-number-2">4</span> Install Nitrogen</h2>
<div class="outline-text-2" id="text-4">


</div>

<div id="outline-container-4-1" class="outline-3">
<h3 id="sec-4-1"><span class="section-number-3">4.1</span> Install Nitrogen</h3>
<div class="outline-text-3" id="text-4-1">



</div>

<div id="outline-container-4-1-1" class="outline-4">
<h4 id="sec-4-1-1"><span class="section-number-4">4.1.1</span> If you <b>don't</b> have Erlang Installed:</h4>
<div class="outline-text-4" id="text-4-1-1">


<p>
<a href="http://nitrogenproject.com/downloads">Download Nitrogen</a>, unzip and <code>cd nitrogen</code>.
</p>
</div>

</div>

<div id="outline-container-4-1-2" class="outline-4">
<h4 id="sec-4-1-2"><span class="section-number-4">4.1.2</span> If you <b>do</b> have Erlang installed:</h4>
<div class="outline-text-4" id="text-4-1-2">


<p>
Pull the <a href="http://github.com/nitrogen/nitrogen">Nitrogen Source Code</a>, then <code>make rel_inets; cd rel/nitrogen</code>.
</p>
</div>
</div>
</div>

</div>

<div id="outline-container-5" class="outline-2">
<h2 id="sec-5"><span class="section-number-2">5</span> Start the Website in Console Mode</h2>
<div class="outline-text-2" id="text-5">


</div>

<div id="outline-container-5-1" class="outline-3">
<h3 id="sec-5-1"><span class="section-number-3">5.1</span> Install &amp; Run Nitrogen</h3>
<div class="outline-text-3" id="text-5-1">


</div>

<div id="outline-container-5-1-1" class="outline-4">
<h4 id="sec-5-1-1"><span class="section-number-4">5.1.1</span> Start Up</h4>
<div class="outline-text-4" id="text-5-1-1">

<pre class="example">
bin/nitrogen console
</pre>


<p>
Open <a href="http://localhost:8000">http://localhost:8000</a> in your Browser
</p>
</div>
</div>
</div>

</div>

<div id="outline-container-6" class="outline-2">
<h2 id="sec-6"><span class="section-number-2">6</span> Stop the Website</h2>
<div class="outline-text-2" id="text-6">


</div>

<div id="outline-container-6-1" class="outline-3">
<h3 id="sec-6-1"><span class="section-number-3">6.1</span> Install &amp; Run Nitrogen</h3>
<div class="outline-text-3" id="text-6-1">


</div>

<div id="outline-container-6-1-1" class="outline-4">
<h4 id="sec-6-1-1"><span class="section-number-4">6.1.1</span> Shut Down</h4>
<div class="outline-text-4" id="text-6-1-1">

<p>    <i>Press Control-C twice.</i>
</p>
</div>

</div>

<div id="outline-container-6-1-2" class="outline-4">
<h4 id="sec-6-1-2"><span class="section-number-4">6.1.2</span> View the Directory</h4>
<div class="outline-text-4" id="text-6-1-2">

<pre class="example">
ls -l
</pre>


</div>
</div>
</div>

</div>

<div id="outline-container-7" class="outline-2">
<h2 id="sec-7"><span class="section-number-2">7</span> Anatomy of a Nitrogen Project</h2>
<div class="outline-text-2" id="text-7">


</div>

<div id="outline-container-7-1" class="outline-3">
<h3 id="sec-7-1"><span class="section-number-3">7.1</span> Install &amp; Run Nitrogen</h3>
<div class="outline-text-3" id="text-7-1">


</div>

<div id="outline-container-7-1-1" class="outline-4">
<h4 id="sec-7-1-1"><span class="section-number-4">7.1.1</span> Anatomy of a Nitrogen Project</h4>
<div class="outline-text-4" id="text-7-1-1">

<dl>
<dt>BuildInfo.txt</dt><dd>From <code>uname</code>.
</dd>
<dt>Makefile</dt><dd>Used by <code>make</code>.
</dd>
<dt>bin/</dt><dd>Commands to start and stop system, plus developer tools.
</dd>
<dt>etc/</dt><dd>Configuration settings.
</dd>
<dt>site/</dt><dd>Contains the website files, templates, and Erlang modules.
</dd>
<dt>log/</dt><dd>The logs.
</dd>
<dt>erts-X.Y.Z/</dt><dd>Embedded Erlang.
</dd>
<dt>releases/</dt><dd>Tells Erlang how to start the system.
</dd>
<dt>lib/</dt><dd>Dependent libraries.
</dd>
</dl>


</div>
</div>
</div>

</div>

<div id="outline-container-8" class="outline-2">
<h2 id="sec-8"><span class="section-number-2">8</span> Anatomy of the site/ Directory</h2>
<div class="outline-text-2" id="text-8">


</div>

<div id="outline-container-8-1" class="outline-3">
<h3 id="sec-8-1"><span class="section-number-3">8.1</span> Install &amp; Run Nitrogen</h3>
<div class="outline-text-3" id="text-8-1">


</div>

<div id="outline-container-8-1-1" class="outline-4">
<h4 id="sec-8-1-1"><span class="section-number-4">8.1.1</span> The <code>site/</code> Directory</h4>
<div class="outline-text-4" id="text-8-1-1">

<p>    The site directory should go under source control, it contains all
    of the information necessary to run the website.
</p>
<dl>
<dt>Emakefile</dt><dd>Used by make.erl to compile the system.
</dd>
<dt>ebin/</dt><dd>Compiled Erlang modules.
</dd>
<dt>include/</dt><dd>Include files for your website.
</dd>
<dt>src/</dt><dd>Erlang source files for your website.
</dd>
<dt>static/</dt><dd>Static files for your website.
</dd>
<dt>templates/</dt><dd>Template files for your website.
</dd>
</dl>


</div>
</div>
</div>

</div>

<div id="outline-container-9" class="outline-2">
<h2 id="sec-9"><span class="section-number-2">9</span> Anatomy of the site/src Directory</h2>
<div class="outline-text-2" id="text-9">


</div>

<div id="outline-container-9-1" class="outline-3">
<h3 id="sec-9-1"><span class="section-number-3">9.1</span> Install &amp; Run Nitrogen</h3>
<div class="outline-text-3" id="text-9-1">


</div>

<div id="outline-container-9-1-1" class="outline-4">
<h4 id="sec-9-1-1"><span class="section-number-4">9.1.1</span> The <code>site/src/</code> Directory</h4>
<div class="outline-text-4" id="text-9-1-1">

<p>    Stores the Erlang source files for your application. By default it
    contains:
</p>
<dl>
<dt>nitrogen_init.erl</dt><dd>Runs once on Nitrogen startup.
</dd>
<dt>nitrogen_PLATFORM.erl</dt><dd>Holds the request loop depending on
         platform.
</dd>
<dt>index.erl</dt><dd>The default web page.
</dd>
<dt>elements/</dt><dd>By convention, custom alements are placed here.
</dd>
<dt>actions/</dt><dd>By convention, custom actions are placed here.
</dd>
</dl>


</div>
</div>
</div>

</div>

<div id="outline-container-10" class="outline-2">
<h2 id="sec-10"><span class="section-number-2">10</span> Exercise: Modify a Nitrogen Page</h2>
<div class="outline-text-2" id="text-10">


</div>

<div id="outline-container-10-1" class="outline-3">
<h3 id="sec-10-1"><span class="section-number-3">10.1</span> Install &amp; Run Nitrogen</h3>
<div class="outline-text-3" id="text-10-1">


</div>

<div id="outline-container-10-1-1" class="outline-4">
<h4 id="sec-10-1-1"><span class="section-number-4">10.1.1</span> Exercise: Modify Your First Page</h4>
<div class="outline-text-4" id="text-10-1-1">

<ul>
<li>From the Erlang Shell, run:
<pre class="example">
sync:go()
</pre>

</li>
<li>Open <code>site/src/index.erl</code>
</li>
<li>Change "Welcome to Nitrogen" to "Welcome to My Website"
</li>
<li>Reload the page
</li>
</ul>


</div>
</div>
</div>

</div>

<div id="outline-container-11" class="outline-2">
<h2 id="sec-11"><span class="section-number-2">11</span> Exercise: Compile in Different Ways</h2>
<div class="outline-text-2" id="text-11">


</div>

<div id="outline-container-11-1" class="outline-3">
<h3 id="sec-11-1"><span class="section-number-3">11.1</span> Install &amp; Run Nitrogen</h3>
<div class="outline-text-3" id="text-11-1">


</div>

<div id="outline-container-11-1-1" class="outline-4">
<h4 id="sec-11-1-1"><span class="section-number-4">11.1.1</span> Exercise: Compile in a Different Way</h4>
<div class="outline-text-4" id="text-11-1-1">

<ul>
<li>From a different terminal, run:
<pre class="example">
bin/dev compile
</pre>

</li>
<li>Change to "Welcome to my ERL-TASTIC WEBSITE!" (or, you know, whatever)
</li>
<li>Reload the page
</li>
</ul>


</div>
</div>
</div>

</div>

<div id="outline-container-12" class="outline-2">
<h2 id="sec-12"><span class="section-number-2">12</span> Dynamic Compiling</h2>
<div class="outline-text-2" id="text-12">


</div>

<div id="outline-container-12-1" class="outline-3">
<h3 id="sec-12-1"><span class="section-number-3">12.1</span> Install &amp; Run Nitrogen</h3>
<div class="outline-text-3" id="text-12-1">


</div>

<div id="outline-container-12-1-1" class="outline-4">
<h4 id="sec-12-1-1"><span class="section-number-4">12.1.1</span> Understanding <code>sync</code></h4>
<div class="outline-text-4" id="text-12-1-1">


<ul>
<li>Running <code>sync:go()</code> from the Erlang shell or <code>bin/dev compile</code> start the
      <code>sync</code> application
</li>
<li>Sync applications constantly checks for changes to Erlang files and
      attempts to recompile
</li>
<li>To stop sync's checking, run <code>sync:stop()</code>
</li>
<li><b>Note</b>: Sync will only recompile files changed <b>since</b> sync was launched.
      Sync is not aware of changes made before running <code>sync:go()</code>
</li>
</ul>


</div>
</div>
</div>

</div>

<div id="outline-container-13" class="outline-2">
<h2 id="sec-13"><span class="section-number-2">13</span> Exercise: Debugging</h2>
<div class="outline-text-2" id="text-13">


</div>

<div id="outline-container-13-1" class="outline-3">
<h3 id="sec-13-1"><span class="section-number-3">13.1</span> Install &amp; Run Nitrogen</h3>
<div class="outline-text-3" id="text-13-1">


</div>

<div id="outline-container-13-1-1" class="outline-4">
<h4 id="sec-13-1-1"><span class="section-number-4">13.1.1</span> Debug Statements</h4>
<div class="outline-text-4" id="text-13-1-1">

<ul>
<li>Add <code>?DEBUG</code> to <code>index.erl</code>. Then compile and
      reload. What happens?
</li>
<li>Add <code>?PRINT(node())</code> to <code>index.erl</code>. Then compile and reload. What
      happens?
</li>
</ul>


</div>
</div>
</div>

</div>

<div id="outline-container-14" class="outline-2">
<h2 id="sec-14"><span class="section-number-2">14</span> Emacs Mode</h2>
<div class="outline-text-2" id="text-14">


</div>

<div id="outline-container-14-1" class="outline-3">
<h3 id="sec-14-1"><span class="section-number-3">14.1</span> Install &amp; Run Nitrogen</h3>
<div class="outline-text-3" id="text-14-1">


</div>

<div id="outline-container-14-1-1" class="outline-4">
<h4 id="sec-14-1-1"><span class="section-number-4">14.1.1</span> Emacs <code>nitrogen-mode</code></h4>
<div class="outline-text-4" id="text-14-1-1">




<pre class="src src-lisp">(add-to-list 'load-path <span class="org-string">"PATH/TO/NITROGEN/support/nitrogen-mode"</span>)
(<span class="org-keyword">require</span> '<span class="org-constant">nitrogen-mode</span>)
</pre>


<p>
    Without <code>nitrogen-mode</code>:
</p>


<pre class="src src-erlang">#<span class="org-type">panel</span> { id=my_panel, body=[
                            #<span class="org-type">panel</span> { id=my_panel2, body=[
                                                         #<span class="org-type">label</span> { text=<span class="org-string">"Name"</span> },
                                                         #<span class="org-type">textbox</span> { id=my_textbox }
                                                        ]}
                           ]}
</pre>


<p>
    With <code>nitrogen-mode</code>:
</p>


<pre class="src src-erlang">M-x nitrogen-mode
#<span class="org-type">panel</span> { id=my_panel, body=[
    #<span class="org-type">panel</span> { id=my_panel2, body=[
        #<span class="org-type">label</span> { text=<span class="org-string">"Name"</span> },
        #<span class="org-type">textbox</span> { id=my_textbox }
    ]}
]}
</pre>


</div>
</div>
</div>

</div>

<div id="outline-container-15" class="outline-2">
<h2 id="sec-15"><span class="section-number-2">15</span> PART 2 AGENDA</h2>
<div class="outline-text-2" id="text-15">


</div>

<div id="outline-container-15-1" class="outline-3">
<h3 id="sec-15-1"><span class="section-number-3">15.1</span> Nitrogen Pages</h3>
<div class="outline-text-3" id="text-15-1">

<ul>
<li>What is a Nitrogen Page?
</li>
<li>Dynamic Routing Explained
</li>
<li>Creating Your First Page
</li>
<li>How is a Page Rendered?
</li>
<li>Anatomy of a Template
</li>
<li>Experimenting With Templates
</li>
</ul>


</div>
</div>

</div>

<div id="outline-container-16" class="outline-2">
<h2 id="sec-16"><span class="section-number-2">16</span> What is a Nitrogen Page?</h2>
<div class="outline-text-2" id="text-16">


</div>

<div id="outline-container-16-1" class="outline-3">
<h3 id="sec-16-1"><span class="section-number-3">16.1</span> Nitrogen Pages</h3>
<div class="outline-text-3" id="text-16-1">


</div>

<div id="outline-container-16-1-1" class="outline-4">
<h4 id="sec-16-1-1"><span class="section-number-4">16.1.1</span> What is a Nitrogen Page</h4>
<div class="outline-text-4" id="text-16-1-1">

<ul>
<li>A Page is an Erlang Module
</li>
<li>Each page should accomplish one store or piece of
      functionality. 

<p>      
      Some examples:
</p><ul>
<li>Allow the user to log in (<code>user_login.erl</code>).
</li>
<li>Change the user's preferences. (<code>user_preferences.erl</code>)
</li>
<li>Display a list of items. (<code>items_view.erl</code>)
</li>
<li>Allow the user to edit an item. (<code>items_edit.erl</code>)
</li>
</ul>

</li>
</ul>


</div>
</div>
</div>

</div>

<div id="outline-container-17" class="outline-2">
<h2 id="sec-17"><span class="section-number-2">17</span> Dynamic Routes Explained</h2>
<div class="outline-text-2" id="text-17">


</div>

<div id="outline-container-17-1" class="outline-3">
<h3 id="sec-17-1"><span class="section-number-3">17.1</span> Nitrogen Pages</h3>
<div class="outline-text-3" id="text-17-1">


</div>

<div id="outline-container-17-1-1" class="outline-4">
<h4 id="sec-17-1-1"><span class="section-number-4">17.1.1</span> Dynamic Routing Explained</h4>
<div class="outline-text-4" id="text-17-1-1">

<p>    Dynamic routing rules:
</p><ol>
<li>If there is an extension, assume a static file.
<pre class="example">
http://localhost:8000/routes/to/a/module
http://localhost:8000/routes/to/a/static/file.html
</pre>

</li>
<li>Root page maps to <code>index.erl</code>
</li>
<li>Replaces slashes with underscores.
<pre class="example">
http://localhost:8000/routes/to/a/module -&gt;
routes_to_a_module.erl
</pre>

</li>
<li>Try the longest matching module.
<pre class="example">
http://localhost:8000/routes/to/a/module/foo/bar -&gt;
routes_to_a_module.erl
</pre>

</li>
<li>Modules that aren't found go to <code>web_404.erl</code> if it exists.
</li>
<li>Static files that aren't found are handled by the underlying
       platform (not yet generalized.)
</li>
</ol>


</div>
</div>
</div>

</div>

<div id="outline-container-18" class="outline-2">
<h2 id="sec-18"><span class="section-number-2">18</span> Creating a New Page</h2>
<div class="outline-text-2" id="text-18">


</div>

<div id="outline-container-18-1" class="outline-3">
<h3 id="sec-18-1"><span class="section-number-3">18.1</span> Nitrogen Pages</h3>
<div class="outline-text-3" id="text-18-1">


</div>

<div id="outline-container-18-1-1" class="outline-4">
<h4 id="sec-18-1-1"><span class="section-number-4">18.1.1</span> Exercise: Create a New Page</h4>
<div class="outline-text-4" id="text-18-1-1">

<ul>
<li>Generate the Page
<pre class="example">
bin/dev page my_page
$EDIT site/src/my_page.erl
</pre>


</li>
<li>Replace the default body with:



<pre class="src src-erlang"><span class="org-function-name">body</span>() -&gt;<span class="org-function-name"> </span><span class="org-string">"Hello World!"</span>.
</pre>


</li>
<li>Remove the <code>event/1</code> function.

</li>
<li>Compile the page and load <code>http://localhost:8080/my/page</code>
</li>
</ul>


</div>
</div>
</div>

</div>

<div id="outline-container-19" class="outline-2">
<h2 id="sec-19"><span class="section-number-2">19</span> How is a Page Rendered (Simple Version)</h2>
<div class="outline-text-2" id="text-19">


</div>

<div id="outline-container-19-1" class="outline-3">
<h3 id="sec-19-1"><span class="section-number-3">19.1</span> Nitrogen Pages</h3>
<div class="outline-text-3" id="text-19-1">


</div>

<div id="outline-container-19-1-1" class="outline-4">
<h4 id="sec-19-1-1"><span class="section-number-4">19.1.1</span> How is a Page Rendered?</h4>
<div class="outline-text-4" id="text-19-1-1">

<ol>
<li>User hits a URL.
</li>
<li>URL is mapped to a module.
</li>
<li>Nitrogen framework calls <code>module:main()</code>
</li>
<li><code>module:main()</code> calls a <code>#template</code> 
</li>
<li><code>#template</code> calls back into the page (or other modules)
</li>
<li>Nitrogen framework renders the output into HTML/Javascript.
</li>
</ol>

<p>    (This is the simple version. Complex version will come later.)
</p>
</div>
</div>
</div>

</div>

<div id="outline-container-20" class="outline-2">
<h2 id="sec-20"><span class="section-number-2">20</span> Anatomy of a Template</h2>
<div class="outline-text-2" id="text-20">


</div>

<div id="outline-container-20-1" class="outline-3">
<h3 id="sec-20-1"><span class="section-number-3">20.1</span> Nitrogen Pages</h3>
<div class="outline-text-3" id="text-20-1">


</div>

<div id="outline-container-20-1-1" class="outline-4">
<h4 id="sec-20-1-1"><span class="section-number-4">20.1.1</span> Anatomy of a Template</h4>
<div class="outline-text-4" id="text-20-1-1">

<ul>
<li>HTML. The Page is slurped into the Template.
</li>
<li>Contains one or more callouts, ie:
<pre class="example">
[[[module:body()]]]
</pre>

</li>
<li>Contains a script callout for Javascript:
<pre class="example">
[[[script]]]
</pre>

</li>
<li>The callouts look like Erlang, but they are not. They can only be
      of the form <code>module:function(Args)</code>. The 'page' module refers to
      the current page.
</li>
</ul>


</div>
</div>
</div>

</div>

<div id="outline-container-21" class="outline-2">
<h2 id="sec-21"><span class="section-number-2">21</span> Experimenting With Templates</h2>
<div class="outline-text-2" id="text-21">


</div>

<div id="outline-container-21-1" class="outline-3">
<h3 id="sec-21-1"><span class="section-number-3">21.1</span> Nitrogen Pages</h3>
<div class="outline-text-3" id="text-21-1">


</div>

<div id="outline-container-21-1-1" class="outline-4">
<h4 id="sec-21-1-1"><span class="section-number-4">21.1.1</span> Experimenting With Templates</h4>
<div class="outline-text-4" id="text-21-1-1">

<ul>
<li>Change the callout from <code>page:body()</code> to <code>page:body1()</code> in the
      default template and reload the page. What happens?

</li>
<li>Create another callout. What happens?

</li>
<li>What happens when you change <code>page</code> to be a specific module?

</li>
<li>Replace the module call with some arbitrary Erlang code. What happens?
</li>
</ul>


</div>
</div>
</div>

</div>

<div id="outline-container-22" class="outline-2">
<h2 id="sec-22"><span class="section-number-2">22</span> PART 3 AGENDA</h2>
<div class="outline-text-2" id="text-22">


</div>

<div id="outline-container-22-1" class="outline-3">
<h3 id="sec-22-1"><span class="section-number-3">22.1</span> Nitrogen Elements</h3>
<div class="outline-text-3" id="text-22-1">

<ul>
<li>What is a Nitrogen Element?
</li>
<li>Add Elements to Your Page
</li>
<li>Nested Elements
</li>
<li>Documentation
</li>
<li>Anatomy of a Nitrogen Element
</li>
</ul>


</div>
</div>

</div>

<div id="outline-container-23" class="outline-2">
<h2 id="sec-23"><span class="section-number-2">23</span> What is a Nitrogen Element?</h2>
<div class="outline-text-2" id="text-23">


</div>

<div id="outline-container-23-1" class="outline-3">
<h3 id="sec-23-1"><span class="section-number-3">23.1</span> Nitrogen Elements</h3>
<div class="outline-text-3" id="text-23-1">


</div>

<div id="outline-container-23-1-1" class="outline-4">
<h4 id="sec-23-1-1"><span class="section-number-4">23.1.1</span> What is a Nitrogen Element?</h4>
<div class="outline-text-4" id="text-23-1-1">

<p>    An element can be either HTML, or some record that renders into
    HTML.
</p>
<p>
    Change this:
</p>


<pre class="src src-erlang"><span class="org-function-name">body</span>() -&gt;<span class="org-function-name"> </span><span class="org-string">"Hello World!"</span>.
</pre>


<p>
    To this:
</p>


<pre class="src src-erlang"><span class="org-function-name">body</span>() -&gt;<span class="org-function-name"> </span>#<span class="org-type">label</span> { text=<span class="org-string">"Hello World!"</span> }.
</pre>


</div>
</div>
</div>

</div>

<div id="outline-container-24" class="outline-2">
<h2 id="sec-24"><span class="section-number-2">24</span> What is a Nitrogen Element?</h2>
<div class="outline-text-2" id="text-24">


</div>

<div id="outline-container-24-1" class="outline-3">
<h3 id="sec-24-1"><span class="section-number-3">24.1</span> Nitrogen Elements</h3>
<div class="outline-text-3" id="text-24-1">


</div>

<div id="outline-container-24-1-1" class="outline-4">
<h4 id="sec-24-1-1"><span class="section-number-4">24.1.1</span> What is a Nitrogen Element?</h4>
<div class="outline-text-4" id="text-24-1-1">

<p>    The <code>#label{}</code> element is rendered into:
</p>



<pre class="src src-html">&lt;<span class="org-function-name">label</span> <span class="org-variable-name">class</span>=<span class="org-string">"wfid_tempNNNNN label"</span>&gt;Hello World!&lt;/<span class="org-function-name">label</span>&gt;
</pre>


<p>
    View the rendered page source in your browser and search for "Hello World".
</p>
</div>
</div>
</div>

</div>

<div id="outline-container-25" class="outline-2">
<h2 id="sec-25"><span class="section-number-2">25</span> Nitrogen Element Properties</h2>
<div class="outline-text-2" id="text-25">


</div>

<div id="outline-container-25-1" class="outline-3">
<h3 id="sec-25-1"><span class="section-number-3">25.1</span> Nitrogen Elements</h3>
<div class="outline-text-3" id="text-25-1">


</div>

<div id="outline-container-25-1-1" class="outline-4">
<h4 id="sec-25-1-1"><span class="section-number-4">25.1.1</span> Why Nitrogen Elements?</h4>
<div class="outline-text-4" id="text-25-1-1">


<p>
    Nitrogen elements serve two purposes:
</p>
<ol>
<li>Allow you to generate HTML within Erlang:
<ul>
<li>Avoid mixing languages == clearer code.
</li>
<li>Fewer characters to type.
</li>
<li>Checked at compile time.

</li>
</ul>

</li>
<li>Abstraction layer:
<ul>
<li>Avoid repeating common functionality.
</li>
<li>Hide complexity in a module.
</li>
</ul>

</li>
</ol>


</div>
</div>
</div>

</div>

<div id="outline-container-26" class="outline-2">
<h2 id="sec-26"><span class="section-number-2">26</span> Nitrogen Element Examples</h2>
<div class="outline-text-2" id="text-26">


</div>

<div id="outline-container-26-1" class="outline-3">
<h3 id="sec-26-1"><span class="section-number-3">26.1</span> Nitrogen Elements</h3>
<div class="outline-text-3" id="text-26-1">


</div>

<div id="outline-container-26-1-1" class="outline-4">
<h4 id="sec-26-1-1"><span class="section-number-4">26.1.1</span> Nitrogen Element Examples</h4>
<div class="outline-text-4" id="text-26-1-1">


<p>    
    Try this on my_page.erl:
</p>


<pre class="src src-erlang"><span class="org-function-name">body</span>() -&gt;<span class="org-function-name"> </span>[
    #<span class="org-type">h1</span> { text=<span class="org-string">"My Simple Application"</span> },
    #<span class="org-type">label</span> { text=<span class="org-string">"What is your name?"</span> },
    #<span class="org-type">textbox</span> { },
    #<span class="org-type">button</span> { text=<span class="org-string">"Submit"</span> }
].
</pre>


<p>
    Then compile, reload, and view source.
</p>
</div>
</div>
</div>

</div>

<div id="outline-container-27" class="outline-2">
<h2 id="sec-27"><span class="section-number-2">27</span> Nested Elements</h2>
<div class="outline-text-2" id="text-27">


</div>

<div id="outline-container-27-1" class="outline-3">
<h3 id="sec-27-1"><span class="section-number-3">27.1</span> Nitrogen Elements</h3>
<div class="outline-text-3" id="text-27-1">


</div>

<div id="outline-container-27-1-1" class="outline-4">
<h4 id="sec-27-1-1"><span class="section-number-4">27.1.1</span> Nested Elements</h4>
<div class="outline-text-4" id="text-27-1-1">


<p>    
    Try a nested element:
</p>



<pre class="src src-erlang"><span class="org-function-name">body</span>() -&gt;<span class="org-function-name"> </span>
    #<span class="org-type">panel</span> { style=<span class="org-string">"margin: 50px;"</span>, body=[
        #<span class="org-type">h1</span> { text=<span class="org-string">"My Page"</span> },
        #<span class="org-type">label</span> { text=<span class="org-string">"Enter Your Name:"</span> },
        #<span class="org-type">textbox</span> { },
        #<span class="org-type">button</span> { text=<span class="org-string">"Submit"</span> }
    ]}.
</pre>


</div>
</div>
</div>

</div>

<div id="outline-container-28" class="outline-2">
<h2 id="sec-28"><span class="section-number-2">28</span> PART 4 AGENDA</h2>
<div class="outline-text-2" id="text-28">


</div>

<div id="outline-container-28-1" class="outline-3">
<h3 id="sec-28-1"><span class="section-number-3">28.1</span> Nitrogen Actions</h3>
<div class="outline-text-3" id="text-28-1">

<ul>
<li>What is a Nitrogen Action?
</li>
<li>Wiring an Action
</li>
<li>Conditional Actions with <code>#event{}</code>
</li>
<li>Postbacks
</li>
</ul>


</div>
</div>

</div>

<div id="outline-container-29" class="outline-2">
<h2 id="sec-29"><span class="section-number-2">29</span> What is a Nitrogen Action?</h2>
<div class="outline-text-2" id="text-29">


</div>

<div id="outline-container-29-1" class="outline-3">
<h3 id="sec-29-1"><span class="section-number-3">29.1</span> Nitrogen Actions</h3>
<div class="outline-text-3" id="text-29-1">


</div>

<div id="outline-container-29-1-1" class="outline-4">
<h4 id="sec-29-1-1"><span class="section-number-4">29.1.1</span> What is a Nitrogen Action?</h4>
<div class="outline-text-4" id="text-29-1-1">

<p>    An action can either be Javascript, or some record that renders
    into Javascript.
</p>
<p>
    Add a Javascript alert to the <code>#button{}</code> element. Then recompile
    and run. What do you expect will happen?
</p>



<pre class="src src-erlang"><span class="org-function-name">body</span>() -&gt;
    [
        #<span class="org-type">button</span> { text=<span class="org-string">"Submit"</span>, actions=[
            #<span class="org-type">event</span>{type=click,actions=<span class="org-string">"alert('hello');"</span> }
        ]}
    ].
</pre>


</div>
</div>
</div>

</div>

<div id="outline-container-30" class="outline-2">
<h2 id="sec-30"><span class="section-number-2">30</span> What is a Nitrogen Action?</h2>
<div class="outline-text-2" id="text-30">


</div>

<div id="outline-container-30-1" class="outline-3">
<h3 id="sec-30-1"><span class="section-number-3">30.1</span> Nitrogen Actions</h3>
<div class="outline-text-3" id="text-30-1">


</div>

<div id="outline-container-30-1-1" class="outline-4">
<h4 id="sec-30-1-1"><span class="section-number-4">30.1.1</span> What is a Nitrogen Action?</h4>
<div class="outline-text-4" id="text-30-1-1">

<p>    Do the same thing a different way.
</p>



<pre class="src src-erlang"><span class="org-function-name">body</span>() -&gt;
    [
        #<span class="org-type">button</span> { text=<span class="org-string">"Submit"</span>, actions=[
          #<span class="org-type">event</span>{type=click, actions=#<span class="org-type">alert</span> { text=<span class="org-string">"Hello"</span> } 
        ]}
    ].
</pre>


</div>
</div>
</div>

</div>

<div id="outline-container-31" class="outline-2">
<h2 id="sec-31"><span class="section-number-2">31</span> Wiring an Action</h2>
<div class="outline-text-2" id="text-31">


</div>

<div id="outline-container-31-1" class="outline-3">
<h3 id="sec-31-1"><span class="section-number-3">31.1</span> Nitrogen Actions</h3>
<div class="outline-text-3" id="text-31-1">


</div>

<div id="outline-container-31-1-1" class="outline-4">
<h4 id="sec-31-1-1"><span class="section-number-4">31.1.1</span> Wiring an Action</h4>
<div class="outline-text-4" id="text-31-1-1">


<p>
    Setting the <code>actions</code> property of an element can lead to messy
    code. Another, cleaner way to wire an action is the <code>wf:wire/N</code>
    function.
</p>



<pre class="src src-erlang"><span class="org-function-name">body</span>() -&gt;<span class="org-function-name"> </span>
    <span class="org-type">wf</span>:<span class="org-type">wire</span>(mybutton, #<span class="org-type">effect</span> { effect=pulsate }),
    [
        #<span class="org-type">button</span> { id=mybutton, text=<span class="org-string">"Submit"</span> }
    ].
</pre>


</div>
</div>
</div>

</div>

<div id="outline-container-32" class="outline-2">
<h2 id="sec-32"><span class="section-number-2">32</span> Conditional Actions with <code>#event{}</code></h2>
<div class="outline-text-2" id="text-32">


</div>

<div id="outline-container-32-1" class="outline-3">
<h3 id="sec-32-1"><span class="section-number-3">32.1</span> Nitrogen Actions</h3>
<div class="outline-text-3" id="text-32-1">


</div>

<div id="outline-container-32-1-1" class="outline-4">
<h4 id="sec-32-1-1"><span class="section-number-4">32.1.1</span> Conditional Actions with <code>#event{}</code></h4>
<div class="outline-text-4" id="text-32-1-1">


<p>
    Put the <code>#effect{}</code> action inside of an <code>#event{}</code> action. This
    causes the effect to <b>only</b> get fired if the user clicks on
    <code>mybutton</code>.
</p>



<pre class="src src-erlang"><span class="org-function-name">body</span>() -&gt;<span class="org-function-name"> </span>
    <span class="org-type">wf</span>:<span class="org-type">wire</span>(mybutton, #<span class="org-type">event</span> { 
        type=click, 
        actions=#<span class="org-type">effect</span> { effect=pulsate }
    }),
    [
        #<span class="org-type">button</span> { id=mybutton, text=<span class="org-string">"Submit"</span> }
    ].
</pre>


</div>
</div>
</div>

</div>

<div id="outline-container-33" class="outline-2">
<h2 id="sec-33"><span class="section-number-2">33</span> Triggers and Targets</h2>
<div class="outline-text-2" id="text-33">


</div>

<div id="outline-container-33-1" class="outline-3">
<h3 id="sec-33-1"><span class="section-number-3">33.1</span> Nitrogen Actions</h3>
<div class="outline-text-3" id="text-33-1">


</div>

<div id="outline-container-33-1-1" class="outline-4">
<h4 id="sec-33-1-1"><span class="section-number-4">33.1.1</span> Triggers and Targets</h4>
<div class="outline-text-4" id="text-33-1-1">


<p>
    All actions have a <code>target</code> property. The <code>target</code> specifies what
    element(s) the action effects.
</p>
<p>
    The event action also has a <code>trigger</code> property. The <code>trigger</code>
    specifies what element(s) trigger the action.
</p>
<p>
    Try this:
</p>



<pre class="src src-erlang"><span class="org-function-name">body</span>() -&gt;<span class="org-function-name"> </span>
    <span class="org-type">wf</span>:<span class="org-type">wire</span>(#<span class="org-type">event</span> { 
        type=click, trigger=mybutton, target=mylabel,
        actions=#<span class="org-type">effect</span> { effect=pulsate }
    }),
    [
        #<span class="org-type">label</span> { id=mylabel, text=<span class="org-string">"Make Me Blink!"</span> },
        #<span class="org-type">button</span> { id=mybutton, text=<span class="org-string">"Submit"</span> }
    ].
</pre>


</div>
</div>
</div>

</div>

<div id="outline-container-34" class="outline-2">
<h2 id="sec-34"><span class="section-number-2">34</span> Triggers and Targets</h2>
<div class="outline-text-2" id="text-34">


</div>

<div id="outline-container-34-1" class="outline-3">
<h3 id="sec-34-1"><span class="section-number-3">34.1</span> Nitrogen Actions</h3>
<div class="outline-text-3" id="text-34-1">


</div>

<div id="outline-container-34-1-1" class="outline-4">
<h4 id="sec-34-1-1"><span class="section-number-4">34.1.1</span> Triggers and Targets</h4>
<div class="outline-text-4" id="text-34-1-1">


<p>
    You can also specify the <b>Trigger</b> and <b>Target</b> directly in <code>wf:wire/N</code>. It takes three forms:
</p>



<pre class="src src-erlang"><span class="org-comment-delimiter">% </span><span class="org-comment">Specify a trigger and target.</span>
<span class="org-type">wf</span>:<span class="org-type">wire</span>(<span class="org-variable-name">Trigger</span>, <span class="org-variable-name">Target</span>, <span class="org-variable-name">Actions</span>)

<span class="org-comment-delimiter">% </span><span class="org-comment">Use the same element for both trigger and target.</span>
<span class="org-type">wf</span>:<span class="org-type">wire</span>(<span class="org-variable-name">TriggerAndTarget</span>, <span class="org-variable-name">Actions</span>)

<span class="org-comment-delimiter">% </span><span class="org-comment">Assume the trigger and/or target is provided in the actions. </span>
<span class="org-comment-delimiter">% </span><span class="org-comment">If not, then wire the action directly to the page. </span>
<span class="org-comment-delimiter">% </span><span class="org-comment">(Useful for catching keystrokes.)</span>
<span class="org-type">wf</span>:<span class="org-type">wire</span>(<span class="org-variable-name">Actions</span>)
</pre>


</div>
</div>
</div>

</div>

<div id="outline-container-35" class="outline-2">
<h2 id="sec-35"><span class="section-number-2">35</span> Quick Review</h2>
<div class="outline-text-2" id="text-35">


</div>

<div id="outline-container-35-1" class="outline-3">
<h3 id="sec-35-1"><span class="section-number-3">35.1</span> Nitrogen Actions</h3>
<div class="outline-text-3" id="text-35-1">


</div>

<div id="outline-container-35-1-1" class="outline-4">
<h4 id="sec-35-1-1"><span class="section-number-4">35.1.1</span> Quick Review</h4>
<div class="outline-text-4" id="text-35-1-1">


<ol>
<li>Elements make HTML.
</li>
<li>Actions make Javascript.
</li>
<li>An action can be wired using the <code>actions</code> property, or wired
       later with <code>wf:wire/N</code>. Both approaches can take a single
       action or a list of actions.
</li>
<li>An action looks for <code>trigger</code> and <code>target</code> properties. These
       can be specified in a few different ways.
</li>
<li>Everything we have seen so far happens on the client.
</li>
</ol>


</div>
</div>
</div>

</div>

<div id="outline-container-36" class="outline-2">
<h2 id="sec-36"><span class="section-number-2">36</span> PART 5 AGENDA</h2>
<div class="outline-text-2" id="text-36">


</div>

<div id="outline-container-36-1" class="outline-3">
<h3 id="sec-36-1"><span class="section-number-3">36.1</span> Nitrogen Events</h3>
<div class="outline-text-3" id="text-36-1">

<ul>
<li>What is a Postback?
</li>
<li>Your First Postback
</li>
<li>Event Properties
</li>
<li>More Event Examples
</li>
<li>Postback Shortcuts
</li>
<li>Modifying Elements
</li>
</ul>

</div>
</div>

</div>

<div id="outline-container-37" class="outline-2">
<h2 id="sec-37"><span class="section-number-2">37</span> What is a Postback?</h2>
<div class="outline-text-2" id="text-37">


</div>

<div id="outline-container-37-1" class="outline-3">
<h3 id="sec-37-1"><span class="section-number-3">37.1</span> Nitrogen Events</h3>
<div class="outline-text-3" id="text-37-1">


</div>

<div id="outline-container-37-1-1" class="outline-4">
<h4 id="sec-37-1-1"><span class="section-number-4">37.1.1</span> What is a Postback?</h4>
<div class="outline-text-4" id="text-37-1-1">


<p>    
    A postback briefly transfers control from the browser to the
    Nitrogen server. It is initiated when an event fires with the
    <code>postback</code> property set. For example:
</p>



<pre class="src src-erlang">#<span class="org-type">event</span> { type=click, postback=my_click_event }
</pre>


<p>
    The postback tag can be any valid Erlang term. You use this to
    differentiate incoming events.
</p>
</div>
</div>
</div>

</div>

<div id="outline-container-38" class="outline-2">
<h2 id="sec-38"><span class="section-number-2">38</span> Your First Postback</h2>
<div class="outline-text-2" id="text-38">


</div>

<div id="outline-container-38-1" class="outline-3">
<h3 id="sec-38-1"><span class="section-number-3">38.1</span> Nitrogen Events</h3>
<div class="outline-text-3" id="text-38-1">


</div>

<div id="outline-container-38-1-1" class="outline-4">
<h4 id="sec-38-1-1"><span class="section-number-4">38.1.1</span> Your First Postback</h4>
<div class="outline-text-4" id="text-38-1-1">


<p>    
    First, let's use the postback to print out a debug message.
</p>



<pre class="src src-erlang"><span class="org-function-name">body</span>() -&gt;<span class="org-function-name"> </span>
    <span class="org-type">wf</span>:<span class="org-type">wire</span>(mybutton, #<span class="org-type">event</span> { type=click, postback=myevent }),
    [
        #<span class="org-type">button</span> { id=mybutton, text=<span class="org-string">"Submit"</span> }
    ].

<span class="org-function-name">event</span>(myevent) -&gt;
    ?<span class="org-constant">PRINT</span>({event, <span class="org-builtin">now</span>()}).
</pre>


</div>
</div>
</div>

</div>

<div id="outline-container-39" class="outline-2">
<h2 id="sec-39"><span class="section-number-2">39</span> Postback Shortcuts</h2>
<div class="outline-text-2" id="text-39">


</div>

<div id="outline-container-39-1" class="outline-3">
<h3 id="sec-39-1"><span class="section-number-3">39.1</span> Nitrogen Events</h3>
<div class="outline-text-3" id="text-39-1">


</div>

<div id="outline-container-39-1-1" class="outline-4">
<h4 id="sec-39-1-1"><span class="section-number-4">39.1.1</span> Postback Shortcuts</h4>
<div class="outline-text-4" id="text-39-1-1">


<p>    
    A few elements allow you to set the <code>postback</code> property as a
    shortcut to handle their most common events.
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<caption></caption>
<colgroup><col class="left" /><col class="left" />
</colgroup>
<tbody>
<tr><td class="left">Element</td><td class="left">Shortcut Event</td></tr>
<tr><td class="left"><code>#button{}</code></td><td class="left">click</td></tr>
<tr><td class="left"><code>#textbox{}</code></td><td class="left">enter key</td></tr>
<tr><td class="left"><code>#checkbox{}</code></td><td class="left">click</td></tr>
<tr><td class="left"><code>#dropdown{}</code></td><td class="left">change</td></tr>
<tr><td class="left"><code>#password{}</code></td><td class="left">enter key</td></tr>
</tbody>
</table>


</div>
</div>
</div>

</div>

<div id="outline-container-40" class="outline-2">
<h2 id="sec-40"><span class="section-number-2">40</span> Postback Shortcuts</h2>
<div class="outline-text-2" id="text-40">


</div>

<div id="outline-container-40-1" class="outline-3">
<h3 id="sec-40-1"><span class="section-number-3">40.1</span> Nitrogen Events</h3>
<div class="outline-text-3" id="text-40-1">


</div>

<div id="outline-container-40-1-1" class="outline-4">
<h4 id="sec-40-1-1"><span class="section-number-4">40.1.1</span> Postback Shortcuts</h4>
<div class="outline-text-4" id="text-40-1-1">


<p>
    A few elements allow you to set the <code>postback</code> property as a
    shortcut to handle their most common events.
</p>
<p>
    The previous code, simplified:
</p>



<pre class="src src-erlang"><span class="org-function-name">body</span>() -&gt;<span class="org-function-name"> </span>
    [
        #<span class="org-type">button</span> { id=mybutton, text=<span class="org-string">"Submit"</span>, postback=myevent }
    ].

<span class="org-function-name">event</span>(myevent) -&gt;
    ?<span class="org-constant">PRINT</span>({event, <span class="org-builtin">now</span>()}).
</pre>


</div>
</div>
</div>

</div>

<div id="outline-container-41" class="outline-2">
<h2 id="sec-41"><span class="section-number-2">41</span> More Event Examples</h2>
<div class="outline-text-2" id="text-41">


</div>

<div id="outline-container-41-1" class="outline-3">
<h3 id="sec-41-1"><span class="section-number-3">41.1</span> Nitrogen Events</h3>
<div class="outline-text-3" id="text-41-1">


</div>

<div id="outline-container-41-1-1" class="outline-4">
<h4 id="sec-41-1-1"><span class="section-number-4">41.1.1</span> More Event Examples</h4>
<div class="outline-text-4" id="text-41-1-1">





<pre class="src src-erlang"><span class="org-function-name">body</span>() -&gt;<span class="org-function-name"> </span>
    <span class="org-comment-delimiter">% </span><span class="org-comment">'mouseover', 'click', and 'mouseout' are standard Javascript</span>
    <span class="org-comment-delimiter">% </span><span class="org-comment">events.</span>
    <span class="org-type">wf</span>:<span class="org-type">wire</span>(mybutton, [
        #<span class="org-type">event</span> { type=mouseover, postback=my_mouseover_event },
        #<span class="org-type">event</span> { type=click, postback=my_click_event },
        #<span class="org-type">event</span> { type=mouseout, postback=my_mouseout_event }
    ]),
    [
        #<span class="org-type">button</span> { id=mybutton, text=<span class="org-string">"Submit"</span> }
    ].

<span class="org-function-name">event</span>(my_click_event) -&gt;
    ?<span class="org-constant">PRINT</span>({click, <span class="org-builtin">now</span>()});
<span class="org-function-name">event</span>(<span class="org-variable-name">OtherEvent</span>) -&gt;
    ?<span class="org-constant">PRINT</span>({other, <span class="org-variable-name">OtherEvent</span>, <span class="org-builtin">now</span>()}).
</pre>


</div>
</div>
</div>

</div>

<div id="outline-container-42" class="outline-2">
<h2 id="sec-42"><span class="section-number-2">42</span> More Event Examples</h2>
<div class="outline-text-2" id="text-42">


</div>

<div id="outline-container-42-1" class="outline-3">
<h3 id="sec-42-1"><span class="section-number-3">42.1</span> Nitrogen Events</h3>
<div class="outline-text-3" id="text-42-1">


</div>

<div id="outline-container-42-1-1" class="outline-4">
<h4 id="sec-42-1-1"><span class="section-number-4">42.1.1</span> More Event Examples</h4>
<div class="outline-text-4" id="text-42-1-1">


<p>    
    Generally, a postback is a good chance to read form elements. The
    <code>wf:q(ElementID)</code> function does this.
</p>



<pre class="src src-erlang"><span class="org-function-name">body</span>() -&gt;<span class="org-function-name"> </span>
    [
        #<span class="org-type">textbox</span> { id=mytextbox, text=<span class="org-string">"Edit this text."</span> },
        #<span class="org-type">button</span> { id=mybutton, text=<span class="org-string">"Submit"</span>, postback=myevent }
    ].

<span class="org-function-name">event</span>(myevent) -&gt;
    <span class="org-variable-name">Text</span> = <span class="org-type">wf</span>:<span class="org-type">q</span>(mytextbox),
    ?<span class="org-constant">PRINT</span>({event, <span class="org-variable-name">Text</span>}).
</pre>


</div>
</div>
</div>

</div>

<div id="outline-container-43" class="outline-2">
<h2 id="sec-43"><span class="section-number-2">43</span> Modifying Elements</h2>
<div class="outline-text-2" id="text-43">


</div>

<div id="outline-container-43-1" class="outline-3">
<h3 id="sec-43-1"><span class="section-number-3">43.1</span> Nitrogen Events</h3>
<div class="outline-text-3" id="text-43-1">


</div>

<div id="outline-container-43-1-1" class="outline-4">
<h4 id="sec-43-1-1"><span class="section-number-4">43.1.1</span> Modifying Elements</h4>
<div class="outline-text-4" id="text-43-1-1">


<p>
    Here is where everything comes together: we are going to modify
    the page from within a postback event. Nitrogen uses <b>AJAX</b> to
    update parts of a page without updating the entire page. 
</p>



<pre class="src src-erlang"><span class="org-function-name">body</span>() -&gt;<span class="org-function-name"> </span>
    #<span class="org-type">panel</span> { style=<span class="org-string">"margin: 50px;"</span>, body=[
        #<span class="org-type">button</span> { id=mybutton, text=<span class="org-string">"Submit"</span>, postback=click },
        #<span class="org-type">panel</span> { id=placeholder, body=<span class="org-string">"This text will be replaced"</span> }
    ]}.

<span class="org-function-name">event</span>(click) -&gt;
    <span class="org-type">wf</span>:<span class="org-type">update</span>(placeholder, [
        #<span class="org-type">h1</span> { text=<span class="org-string">"Congratulations!"</span> },
        #<span class="org-type">p</span> { body=<span class="org-string">"You have updated the page!"</span> },
        #<span class="org-type">p</span> { body=<span class="org-type">io_lib</span>:<span class="org-type">format</span>(<span class="org-string">"~p"</span>, [<span class="org-builtin">now</span>()]) }
    ]).
</pre>


</div>
</div>
</div>

</div>

<div id="outline-container-44" class="outline-2">
<h2 id="sec-44"><span class="section-number-2">44</span> More Page Manipulation</h2>
<div class="outline-text-2" id="text-44">


</div>

<div id="outline-container-44-1" class="outline-3">
<h3 id="sec-44-1"><span class="section-number-3">44.1</span> Nitrogen Events</h3>
<div class="outline-text-3" id="text-44-1">


</div>

<div id="outline-container-44-1-1" class="outline-4">
<h4 id="sec-44-1-1"><span class="section-number-4">44.1.1</span> More Page Manipulation</h4>
<div class="outline-text-4" id="text-44-1-1">


<p>
    The <code>wf</code> module exposes many manipulation functions:
</p>
<dl>
<dt><code>wf:update/2</code></dt><dd>Update the contents of an element with another element(s).
</dd>
<dt><code>wf:insert_top/2</code></dt><dd>Insert a new element(s) at the beginning of another element.
</dd>
<dt><code>wf:insert_bottom/2</code></dt><dd>Insert a new element(s) at the bottom of another element.
</dd>
<dt><code>wf:replace/2</code></dt><dd>Replace an element with another element.
</dd>
<dt><code>wf:remove/1</code></dt><dd>Remove an element(s).
</dd>
<dt><code>wf:set/2</code></dt><dd>Set a textbox or checkbox value.
</dd>
</dl>


<p>
    It also exposes many other generally useful utility functions:
    <a href="http://nitrogenproject.com/doc/api.html">http://nitrogenproject.com/doc/api.html</a>
</p>
</div>
</div>
</div>

</div>

<div id="outline-container-45" class="outline-2">
<h2 id="sec-45"><span class="section-number-2">45</span> PART 6 AGENDA</h2>
<div class="outline-text-2" id="text-45">


</div>

<div id="outline-container-45-1" class="outline-3">
<h3 id="sec-45-1"><span class="section-number-3">45.1</span> Remembering State</h3>
<div class="outline-text-3" id="text-45-1">

<ul>
<li>Page State vs. Session State
</li>
<li>Page State Example
</li>
<li>Session State Example
</li>
</ul>

</div>
</div>

</div>

<div id="outline-container-46" class="outline-2">
<h2 id="sec-46"><span class="section-number-2">46</span> Page State vs. Session State</h2>
<div class="outline-text-2" id="text-46">


</div>

<div id="outline-container-46-1" class="outline-3">
<h3 id="sec-46-1"><span class="section-number-3">46.1</span> Remembering State</h3>
<div class="outline-text-3" id="text-46-1">


</div>

<div id="outline-container-46-1-1" class="outline-4">
<h4 id="sec-46-1-1"><span class="section-number-4">46.1.1</span> Page State vs. Session State</h4>
<div class="outline-text-4" id="text-46-1-1">


<p>
    Nitrogen can store two kinds of state:
</p>
<ul>
<li><b>Page State</b>
<ul>
<li>Stored in a user's browser window. 
</li>
<li>Destroyed when the user closes the window or navigates to a
        different page.
</li>
<li>Sent across the wire with each request.

</li>
</ul>

</li>
<li><b>Session State</b>
<ul>
<li>Stored in server memory. 
</li>
<li>Destroyed when the session expires or the Erlang VM dies.
</li>
<li>Associated with the user's session by an HTTP cookie.
</li>
<li>Useful place to store authentication
</li>
</ul>

</li>
</ul>


</div>
</div>
</div>

</div>

<div id="outline-container-47" class="outline-2">
<h2 id="sec-47"><span class="section-number-2">47</span> Page State</h2>
<div class="outline-text-2" id="text-47">


</div>

<div id="outline-container-47-1" class="outline-3">
<h3 id="sec-47-1"><span class="section-number-3">47.1</span> Remembering State</h3>
<div class="outline-text-3" id="text-47-1">


</div>

<div id="outline-container-47-1-1" class="outline-4">
<h4 id="sec-47-1-1"><span class="section-number-4">47.1.1</span> Page State</h4>
<div class="outline-text-4" id="text-47-1-1">


<p>
    Using Page State:
</p>



<pre class="src src-erlang"><span class="org-comment-delimiter">% </span><span class="org-comment">Set a state variable</span>
<span class="org-type">wf</span>:<span class="org-type">state</span>(<span class="org-variable-name">Key</span>, <span class="org-variable-name">Value</span>)

<span class="org-comment-delimiter">% </span><span class="org-comment">Get a state variable</span>
<span class="org-type">wf</span>:<span class="org-type">state</span>(<span class="org-variable-name">Key</span>)
<span class="org-type">wf</span>:<span class="org-type">state_default</span>(<span class="org-variable-name">Key</span>, <span class="org-variable-name">DefaultValue</span>)
</pre>


<p>
    <code>Key</code> and <code>Value</code> can be any valid Erlang term.
</p>
<p>
    <b>Exercise:</b> Modify my_page.erl to display a counter that gets
    incremented every time you press the 'Submit' button. The counter
    should reset when the user reloads the page.
</p>
</div>
</div>
</div>

</div>

<div id="outline-container-48" class="outline-2">
<h2 id="sec-48"><span class="section-number-2">48</span> Page State</h2>
<div class="outline-text-2" id="text-48">


</div>

<div id="outline-container-48-1" class="outline-3">
<h3 id="sec-48-1"><span class="section-number-3">48.1</span> Remembering State</h3>
<div class="outline-text-3" id="text-48-1">


</div>

<div id="outline-container-48-1-1" class="outline-4">
<h4 id="sec-48-1-1"><span class="section-number-4">48.1.1</span> Page State</h4>
<div class="outline-text-4" id="text-48-1-1">





<pre class="src src-erlang"><span class="org-function-name">body</span>() -&gt;
    #<span class="org-type">panel</span> { style=<span class="org-string">"margin: 50px;"</span>, body=[
        #<span class="org-type">button</span> { id=mybutton, text=<span class="org-string">"Submit"</span>, postback=click },
        #<span class="org-type">panel</span> { id=placeholder, body=<span class="org-string">"1"</span> }
    ]}.

<span class="org-function-name">event</span>(click) -&gt;
    <span class="org-variable-name">Counter</span> = <span class="org-type">wf</span>:<span class="org-type">state_default</span>(counter, 1),
    <span class="org-type">wf</span>:<span class="org-type">update</span>(placeholder, [
        #<span class="org-type">panel</span> { body=<span class="org-type">io_lib</span>:<span class="org-type">format</span>(<span class="org-string">"~p"</span>, [<span class="org-variable-name">Counter</span> + 1]) }
    ]),
    <span class="org-type">wf</span>:<span class="org-type">state</span>(counter, <span class="org-variable-name">Counter</span> + 1).
</pre>


</div>
</div>
</div>

</div>

<div id="outline-container-49" class="outline-2">
<h2 id="sec-49"><span class="section-number-2">49</span> Session State</h2>
<div class="outline-text-2" id="text-49">


</div>

<div id="outline-container-49-1" class="outline-3">
<h3 id="sec-49-1"><span class="section-number-3">49.1</span> Remembering State</h3>
<div class="outline-text-3" id="text-49-1">


</div>

<div id="outline-container-49-1-1" class="outline-4">
<h4 id="sec-49-1-1"><span class="section-number-4">49.1.1</span> Session State</h4>
<div class="outline-text-4" id="text-49-1-1">


<p>
    Using Session State:
</p>



<pre class="src src-erlang"><span class="org-comment-delimiter">% </span><span class="org-comment">Set a session state variable</span>
<span class="org-type">wf</span>:<span class="org-type">session</span>(<span class="org-variable-name">Key</span>, <span class="org-variable-name">Value</span>)

<span class="org-comment-delimiter">% </span><span class="org-comment">Get a session state variable</span>
<span class="org-type">wf</span>:<span class="org-type">session</span>(<span class="org-variable-name">Key</span>)
<span class="org-type">wf</span>:<span class="org-type">session_default</span>(<span class="org-variable-name">Key</span>, <span class="org-variable-name">DefaultValue</span>)
</pre>


<p>
    <code>Key</code> and <code>Value</code> can be any valid Erlang term.
</p>
<p>
    <b>Exercise:</b> Modify my_page.erl to display <b>TWO</b> counters. When the
    user presses the 'Submit' button, one counter should get
    incremented, the other counter should get doubled. The server
    should remember the counters even if the user closes and then re-opens
    the browser.
</p>
</div>
</div>
</div>

</div>

<div id="outline-container-50" class="outline-2">
<h2 id="sec-50"><span class="section-number-2">50</span> Session State</h2>
<div class="outline-text-2" id="text-50">


</div>

<div id="outline-container-50-1" class="outline-3">
<h3 id="sec-50-1"><span class="section-number-3">50.1</span> Remembering State</h3>
<div class="outline-text-3" id="text-50-1">


</div>

<div id="outline-container-50-1-1" class="outline-4">
<h4 id="sec-50-1-1"><span class="section-number-4">50.1.1</span> Session State</h4>
<div class="outline-text-4" id="text-50-1-1">




<pre class="src src-erlang"><span class="org-function-name">body</span>() -&gt;
    #<span class="org-type">panel</span> { style=<span class="org-string">"margin: 50px;"</span>, body=[
        #<span class="org-type">button</span> { id=mybutton, text=<span class="org-string">"Submit"</span>, postback=click },
        #<span class="org-type">panel</span> { id=placeholder1, body=<span class="org-string">"1"</span> },
        #<span class="org-type">panel</span> { id=placeholder2, body=<span class="org-string">"1"</span> }
    ]}.

<span class="org-function-name">event</span>(click) -&gt;
    <span class="org-comment-delimiter">%% </span><span class="org-comment">Increment the counter...</span>
    <span class="org-variable-name">Counter1</span> = <span class="org-type">wf</span>:<span class="org-type">session_default</span>(counter1, 1),
    <span class="org-type">wf</span>:<span class="org-type">update</span>(placeholder1, <span class="org-type">io_lib</span>:<span class="org-type">format</span>(<span class="org-string">"~p"</span>, [<span class="org-variable-name">Counter1</span> + 1])),
    <span class="org-type">wf</span>:<span class="org-type">session</span>(counter1, <span class="org-variable-name">Counter1</span> + 1),

    <span class="org-comment-delimiter">%% </span><span class="org-comment">Double the other counter...</span>
    <span class="org-variable-name">Counter2</span> = <span class="org-type">wf</span>:<span class="org-type">session_default</span>(counter2, 1),
    <span class="org-type">wf</span>:<span class="org-type">update</span>(placeholder2, <span class="org-type">io_lib</span>:<span class="org-type">format</span>(<span class="org-string">"~p"</span>, [<span class="org-variable-name">Counter2</span> * 2])),
    <span class="org-type">wf</span>:<span class="org-type">session</span>(counter2, <span class="org-variable-name">Counter2</span> * 2).
</pre>


</div>
</div>
</div>

</div>

<div id="outline-container-51" class="outline-2">
<h2 id="sec-51"><span class="section-number-2">51</span> PART 7 AGENDA</h2>
<div class="outline-text-2" id="text-51">


</div>

<div id="outline-container-51-1" class="outline-3">
<h3 id="sec-51-1"><span class="section-number-3">51.1</span> Security</h3>
<div class="outline-text-3" id="text-51-1">

<ul>
<li>Limiting Access to a Page
</li>
<li>Authentication and Authorization Functions
</li>
<li>Page Redirection Functions
</li>
<li>Creating a Secure Page
</li>
</ul>

</div>
</div>

</div>

<div id="outline-container-52" class="outline-2">
<h2 id="sec-52"><span class="section-number-2">52</span> Limiting Access to a Page</h2>
<div class="outline-text-2" id="text-52">


</div>

<div id="outline-container-52-1" class="outline-3">
<h3 id="sec-52-1"><span class="section-number-3">52.1</span> Security</h3>
<div class="outline-text-3" id="text-52-1">


</div>

<div id="outline-container-52-1-1" class="outline-4">
<h4 id="sec-52-1-1"><span class="section-number-4">52.1.1</span> Limiting Access to a Page</h4>
<div class="outline-text-4" id="text-52-1-1">


<p>
    Nitrogen contains functions to help you build password protected websites:
</p>
<ul>
<li>Nitrogen is built for role-based security. You set the roles for
      a current session, and check those roles later.

<p>
      For example, the user may have the <code>friend</code> and <code>manager</code>
       roles, but not the <code>administrator</code> role.
</p>
</li>
<li>Authentication/authorization info is stored in the session. 
</li>
</ul>


</div>
</div>
</div>

</div>

<div id="outline-container-53" class="outline-2">
<h2 id="sec-53"><span class="section-number-2">53</span> Authentication and Authorization Functions</h2>
<div class="outline-text-2" id="text-53">


</div>

<div id="outline-container-53-1" class="outline-3">
<h3 id="sec-53-1"><span class="section-number-3">53.1</span> Security</h3>
<div class="outline-text-3" id="text-53-1">


</div>

<div id="outline-container-53-1-1" class="outline-4">
<h4 id="sec-53-1-1"><span class="section-number-4">53.1.1</span> Authentication and Authorization Functions</h4>
<div class="outline-text-4" id="text-53-1-1">


<p>
    Functions to set the user/role:
</p>



<pre class="src src-erlang"><span class="org-comment-delimiter">% </span><span class="org-comment">Get/set the current user for this session.</span>
<span class="org-type">wf</span>:<span class="org-type">user</span>(), <span class="org-type">wf</span>:<span class="org-type">user</span>(<span class="org-variable-name">User</span>)

<span class="org-comment-delimiter">% </span><span class="org-comment">Get/set whether the current session has the specified role.</span>
<span class="org-type">wf</span>:<span class="org-type">role</span>(<span class="org-variable-name">Role</span>), <span class="org-type">wf</span>:<span class="org-type">role</span>(<span class="org-variable-name">Role</span>, <span class="org-variable-name">IsInRole</span>)
</pre>


</div>
</div>
</div>

</div>

<div id="outline-container-54" class="outline-2">
<h2 id="sec-54"><span class="section-number-2">54</span> Page Redirection Functions</h2>
<div class="outline-text-2" id="text-54">


</div>

<div id="outline-container-54-1" class="outline-3">
<h3 id="sec-54-1"><span class="section-number-3">54.1</span> Security</h3>
<div class="outline-text-3" id="text-54-1">


</div>

<div id="outline-container-54-1-1" class="outline-4">
<h4 id="sec-54-1-1"><span class="section-number-4">54.1.1</span> Page Redirection Functions</h4>
<div class="outline-text-4" id="text-54-1-1">


<p>
    Functions kick the user to a login page:
</p>



<pre class="src src-erlang"><span class="org-comment-delimiter">% </span><span class="org-comment">Redirect the user to a different page.</span>
<span class="org-type">wf</span>:<span class="org-type">redirect</span>(<span class="org-variable-name">Url</span>)

<span class="org-comment-delimiter">% </span><span class="org-comment">Redirect the user to the login page.</span>
<span class="org-type">wf</span>:<span class="org-type">redirect_to_login</span>(<span class="org-variable-name">LoginUrl</span>)

<span class="org-comment-delimiter">% </span><span class="org-comment">Redirect the user back to the original page they </span>
<span class="org-comment-delimiter">% </span><span class="org-comment">tried to access.  </span>
<span class="org-type">wf</span>:<span class="org-type">redirect_from_login</span>(<span class="org-variable-name">DefaultUrl</span>)
</pre>


</div>
</div>
</div>

</div>

<div id="outline-container-55" class="outline-2">
<h2 id="sec-55"><span class="section-number-2">55</span> Creating a Secure Page - Step 1</h2>
<div class="outline-text-2" id="text-55">


</div>

<div id="outline-container-55-1" class="outline-3">
<h3 id="sec-55-1"><span class="section-number-3">55.1</span> Security</h3>
<div class="outline-text-3" id="text-55-1">


</div>

<div id="outline-container-55-1-1" class="outline-4">
<h4 id="sec-55-1-1"><span class="section-number-4">55.1.1</span> Creating a Secure Page - Step 1</h4>
<div class="outline-text-4" id="text-55-1-1">


<p>    
    Check for the <code>managers</code> role at the top of a page. If the user
    doesn't have the role, go to a login page.
</p>



<pre class="src src-erlang"><span class="org-function-name">main</span>() -&gt;<span class="org-function-name"> </span>
    <span class="org-keyword">case</span> <span class="org-type">wf</span>:<span class="org-type">role</span>(managers) <span class="org-keyword">of</span>
        true -&gt;
            #<span class="org-type">template</span> { file=<span class="org-string">"./site/templates/bare.html"</span> };
        false -&gt;
            <span class="org-type">wf</span>:<span class="org-type">redirect_to_login</span>(<span class="org-string">"/login"</span>)
    <span class="org-keyword">end</span>.
</pre>


</div>
</div>
</div>

</div>

<div id="outline-container-56" class="outline-2">
<h2 id="sec-56"><span class="section-number-2">56</span> Creating a Secure Page - Step 2</h2>
<div class="outline-text-2" id="text-56">


</div>

<div id="outline-container-56-1" class="outline-3">
<h3 id="sec-56-1"><span class="section-number-3">56.1</span> Security</h3>
<div class="outline-text-3" id="text-56-1">


</div>

<div id="outline-container-56-1-1" class="outline-4">
<h4 id="sec-56-1-1"><span class="section-number-4">56.1.1</span> Creating a Secure Page - Step 2</h4>
<div class="outline-text-4" id="text-56-1-1">


<p>
    Create a login page. For now, just create a button that, when
    clicked, grants the <code>managers</code> role to the user and redirects
    back.
</p>



<pre class="src src-erlang"><span class="org-function-name">body</span>() -&gt;
    #<span class="org-type">button</span> { text=<span class="org-string">"Login"</span>, postback=login }.

<span class="org-function-name">event</span>(login) -&gt;
    <span class="org-type">wf</span>:<span class="org-type">role</span>(managers, true),
    <span class="org-type">wf</span>:<span class="org-type">redirect_from_login</span>(<span class="org-string">"/"</span>).
</pre>


</div>
</div>
</div>

</div>

<div id="outline-container-57" class="outline-2">
<h2 id="sec-57"><span class="section-number-2">57</span> Creating a Secure Page - Step 3</h2>
<div class="outline-text-2" id="text-57">


</div>

<div id="outline-container-57-1" class="outline-3">
<h3 id="sec-57-1"><span class="section-number-3">57.1</span> Security</h3>
<div class="outline-text-3" id="text-57-1">


</div>

<div id="outline-container-57-1-1" class="outline-4">
<h4 id="sec-57-1-1"><span class="section-number-4">57.1.1</span> Creating a Secure Page - Step 3</h4>
<div class="outline-text-4" id="text-57-1-1">


<p>    
    Update <code>login.erl</code> to prompt for a username and password.
</p>



<pre class="src src-erlang"><span class="org-function-name">body</span>() -&gt;<span class="org-function-name"> </span>
    #<span class="org-type">panel</span> { style=<span class="org-string">"margin: 50px;"</span>, body=[
        #<span class="org-type">flash</span> {},
        #<span class="org-type">label</span> { text=<span class="org-string">"Username"</span> },
        #<span class="org-type">textbox</span> { id=username, next=password },
        #<span class="org-type">br</span> {},
        #<span class="org-type">label</span> { text=<span class="org-string">"Password"</span> },
        #<span class="org-type">password</span> { id=password, next=submit },
        #<span class="org-type">br</span> {},
        #<span class="org-type">button</span> { text=<span class="org-string">"Login"</span>, id=submit, postback=login }
    ]}.

<span class="org-function-name">event</span>(login) -&gt;
    <span class="org-keyword">case</span> <span class="org-type">wf</span>:<span class="org-type">q</span>(password) == <span class="org-string">"password"</span> <span class="org-keyword">of</span>
        true -&gt;
            <span class="org-type">wf</span>:<span class="org-type">role</span>(managers, true),
            <span class="org-type">wf</span>:<span class="org-type">redirect_from_login</span>(<span class="org-string">"/"</span>);
        false -&gt;
            <span class="org-type">wf</span>:<span class="org-type">flash</span>(<span class="org-string">"Invalid password."</span>)
    <span class="org-keyword">end</span>.
</pre>


</div>
</div>
</div>

</div>

<div id="outline-container-58" class="outline-2">
<h2 id="sec-58"><span class="section-number-2">58</span> Creating a Secure Page - Step 4</h2>
<div class="outline-text-2" id="text-58">


</div>

<div id="outline-container-58-1" class="outline-3">
<h3 id="sec-58-1"><span class="section-number-3">58.1</span> Security</h3>
<div class="outline-text-3" id="text-58-1">


</div>

<div id="outline-container-58-1-1" class="outline-4">
<h4 id="sec-58-1-1"><span class="section-number-4">58.1.1</span> Creating a Secure Page - Step 4</h4>
<div class="outline-text-4" id="text-58-1-1">


<p>    
    Create a way for the user to logout.
</p>



<pre class="src src-erlang"><span class="org-comment-delimiter">% </span><span class="org-comment">Clears all user, roles, session state, and page state.</span>
<span class="org-type">wf</span>:<span class="org-type">logout</span>()
</pre>


<p>
    <i>Note: Placing this statement appropriately is left as an exercise for the reader.</i>
</p>
</div>
</div>
</div>

</div>

<div id="outline-container-59" class="outline-2">
<h2 id="sec-59"><span class="section-number-2">59</span> PART 8 AGENDA</h2>
<div class="outline-text-2" id="text-59">


</div>

<div id="outline-container-59-1" class="outline-3">
<h3 id="sec-59-1"><span class="section-number-3">59.1</span> Validation</h3>
<div class="outline-text-3" id="text-59-1">

<ul>
<li>Overview of Nitrogen Validation
</li>
<li>Adding Some Validators
</li>
</ul>


</div>
</div>

</div>

<div id="outline-container-60" class="outline-2">
<h2 id="sec-60"><span class="section-number-2">60</span> Overview of Nitrogen Validation</h2>
<div class="outline-text-2" id="text-60">


</div>

<div id="outline-container-60-1" class="outline-3">
<h3 id="sec-60-1"><span class="section-number-3">60.1</span> Validation</h3>
<div class="outline-text-3" id="text-60-1">


</div>

<div id="outline-container-60-1-1" class="outline-4">
<h4 id="sec-60-1-1"><span class="section-number-4">60.1.1</span> Overview of Nitrogen Validation</h4>
<div class="outline-text-4" id="text-60-1-1">


<p>    
    Nitrogen implements a validation framework, plus a number of
    pre-built validators, to allow you to declaratively validate your
    form variables.
</p>
<p>
    Validation happens on both client side (using the LiveValidation
    library) and server side (in Erlang). 
</p>
<p>
    This is done to present a responsive front end to the user 
</p>
</div>
</div>
</div>

</div>

<div id="outline-container-61" class="outline-2">
<h2 id="sec-61"><span class="section-number-2">61</span> Overview of Nitrogen Validation</h2>
<div class="outline-text-2" id="text-61">


</div>

<div id="outline-container-61-1" class="outline-3">
<h3 id="sec-61-1"><span class="section-number-3">61.1</span> Validation</h3>
<div class="outline-text-3" id="text-61-1">


</div>

<div id="outline-container-61-1-1" class="outline-4">
<h4 id="sec-61-1-1"><span class="section-number-4">61.1.1</span> Overview of Nitrogen Validation</h4>
<div class="outline-text-4" id="text-61-1-1">


<p>
    The simplest validator is the <code>#is_required{}</code> validator. Tell your
    <code>login.erl</code> page to make sure the user enters both a username and
    a password.
</p>



<pre class="src src-erlang"><span class="org-function-name">body</span>() -&gt;<span class="org-function-name"> </span>
    <span class="org-type">wf</span>:<span class="org-type">wire</span>(submit, username, #<span class="org-type">validate</span> { validators=[
        #<span class="org-type">is_required</span> { text=<span class="org-string">"Required."</span> }
    ]}),
    <span class="org-type">wf</span>:<span class="org-type">wire</span>(submit, password, #<span class="org-type">validate</span> { validators=[
        #<span class="org-type">is_required</span> { text=<span class="org-string">"Required."</span> }
    ]}),
    #<span class="org-type">panel</span> { style=<span class="org-string">"margin: 50px;"</span>, body=[
        ...
</pre>


</div>
</div>
</div>

</div>

<div id="outline-container-62" class="outline-2">
<h2 id="sec-62"><span class="section-number-2">62</span> Overview of Nitrogen Validation</h2>
<div class="outline-text-2" id="text-62">


</div>

<div id="outline-container-62-1" class="outline-3">
<h3 id="sec-62-1"><span class="section-number-3">62.1</span> Validation</h3>
<div class="outline-text-3" id="text-62-1">


</div>

<div id="outline-container-62-1-1" class="outline-4">
<h4 id="sec-62-1-1"><span class="section-number-4">62.1.1</span> Overview of Nitrogen Validation</h4>
<div class="outline-text-4" id="text-62-1-1">


<p>
    We can get clever and use a validator to check that the user
    entered the correct password. The <code>#custom{}</code> validator runs on
    the server. (To make a custom client-side validator, use
    <code>#js_custom{}</code>.)
</p>



<pre class="src src-erlang"><span class="org-function-name">body</span>() -&gt;<span class="org-function-name"> </span>
    <span class="org-type">wf</span>:<span class="org-type">wire</span>(submit, username, #<span class="org-type">validate</span> { validators=[
        #<span class="org-type">is_required</span> { text=<span class="org-string">"Required."</span> }
    ]}),
    <span class="org-type">wf</span>:<span class="org-type">wire</span>(submit, password, #<span class="org-type">validate</span> { validators=[
        #<span class="org-type">is_required</span> { text=<span class="org-string">"Required."</span> },
        #<span class="org-type">custom</span> { 
            text=<span class="org-string">"Invalid password."</span>, 
            function=<span class="org-keyword">fun</span>(<span class="org-variable-name">_</span>, <span class="org-variable-name">Value</span>) -&gt;<span class="org-function-name"> </span><span class="org-variable-name">Value</span> == <span class="org-string">"password"</span> <span class="org-keyword">end</span>
        }
    ]}),
    #<span class="org-type">panel</span> { style=<span class="org-string">"margin: 50px;"</span>, body=[
        ...
</pre>


</div>
</div>
</div>

</div>

<div id="outline-container-63" class="outline-2">
<h2 id="sec-63"><span class="section-number-2">63</span> Overview of Nitrogen Validation</h2>
<div class="outline-text-2" id="text-63">


</div>

<div id="outline-container-63-1" class="outline-3">
<h3 id="sec-63-1"><span class="section-number-3">63.1</span> Validation</h3>
<div class="outline-text-3" id="text-63-1">


</div>

<div id="outline-container-63-1-1" class="outline-4">
<h4 id="sec-63-1-1"><span class="section-number-4">63.1.1</span> Overview of Nitrogen Validation</h4>
<div class="outline-text-4" id="text-63-1-1">


<p>
    Since we validate the password in the <code>#custom</code> validator, we can
    trust that the <code>login</code> event only fires when the password is
    correct. Change the <code>login</code> event to:
</p>



<pre class="src src-erlang"><span class="org-function-name">event</span>(login) -&gt;
    <span class="org-type">wf</span>:<span class="org-type">role</span>(managers, true),
    <span class="org-type">wf</span>:<span class="org-type">redirect_from_login</span>(<span class="org-string">"/"</span>).
</pre>


</div>
</div>
</div>

</div>

<div id="outline-container-64" class="outline-2">
<h2 id="sec-64"><span class="section-number-2">64</span> PART 9 AGENDA</h2>
<div class="outline-text-2" id="text-64">


</div>

<div id="outline-container-64-1" class="outline-3">
<h3 id="sec-64-1"><span class="section-number-3">64.1</span> Comet</h3>
<div class="outline-text-3" id="text-64-1">

<ul>
<li>What is Comet?
</li>
<li>Comet the Nitrogen/Erlang Way
</li>
<li>A Comet Counter
</li>
<li>Comet Pools
</li>
<li>Comet Pool Scope
</li>
<li>The Simplest Chatroom Ever Constructed
</li>
</ul>


</div>
</div>

</div>

<div id="outline-container-65" class="outline-2">
<h2 id="sec-65"><span class="section-number-2">65</span> What is Comet?</h2>
<div class="outline-text-2" id="text-65">


</div>

<div id="outline-container-65-1" class="outline-3">
<h3 id="sec-65-1"><span class="section-number-3">65.1</span> Comet</h3>
<div class="outline-text-3" id="text-65-1">


</div>

<div id="outline-container-65-1-1" class="outline-4">
<h4 id="sec-65-1-1"><span class="section-number-4">65.1.1</span> What is Comet?</h4>
<div class="outline-text-4" id="text-65-1-1">


<p>
    <b>Comet</b> is the name for a technique where the browser requests
    something from the server, and the server doesn't respond until
    it has something useful to say.
</p>
<p>
    This makes it useful for applications that need fast, out-of-band
    communication, such as chat rooms. 
</p>
<p>    
    In other words, you don't need to keep hitting a "Get Messages"
    button. The server just pushes messages when they are available.
</p>
<p>
    <i>A big happy shout out to Tom McNulty for his innovative ideas on what     Comet support could look like in Nitrogen.</i>
</p>
</div>
</div>
</div>

</div>

<div id="outline-container-66" class="outline-2">
<h2 id="sec-66"><span class="section-number-2">66</span> Comet the Nitrogen/Erlang Way</h2>
<div class="outline-text-2" id="text-66">


</div>

<div id="outline-container-66-1" class="outline-3">
<h3 id="sec-66-1"><span class="section-number-3">66.1</span> Comet</h3>
<div class="outline-text-3" id="text-66-1">


</div>

<div id="outline-container-66-1-1" class="outline-4">
<h4 id="sec-66-1-1"><span class="section-number-4">66.1.1</span> Comet the Nitrogen/Erlang Way</h4>
<div class="outline-text-4" id="text-66-1-1">


<p>
    Think of Comet like <code>erlang:spawn/1</code>:
</p>
<ul>
<li>Start up a function.

</li>
<li>The function can manipulate the page using <code>wf:update/2</code> or any
      other page manipulation function.

</li>
<li>Output is queued until the function ends or calls <code>wf:flush/0</code>.

</li>
<li>The function acts like it is linked to the current user's
      page. It is killed when the user leaves the page (or receives
      <code>{'EXIT', _, Message}</code> if <code>trap_exit</code> is <code>true</code>.)
</li>
</ul>


</div>
</div>
</div>

</div>

<div id="outline-container-67" class="outline-2">
<h2 id="sec-67"><span class="section-number-2">67</span> A Comet Counter</h2>
<div class="outline-text-2" id="text-67">


</div>

<div id="outline-container-67-1" class="outline-3">
<h3 id="sec-67-1"><span class="section-number-3">67.1</span> Comet</h3>
<div class="outline-text-3" id="text-67-1">


</div>

<div id="outline-container-67-1-1" class="outline-4">
<h4 id="sec-67-1-1"><span class="section-number-4">67.1.1</span> A Comet Counter</h4>
<div class="outline-text-4" id="text-67-1-1">


<p>
    Update <code>my_page.erl</code> to count once per second.
</p>



<pre class="src src-erlang"><span class="org-function-name">body</span>() -&gt;<span class="org-function-name"> </span>
    <span class="org-type">wf</span>:<span class="org-type">comet</span>(<span class="org-keyword">fun</span>() -&gt;<span class="org-function-name"> </span><span class="org-type">counter</span>(1) <span class="org-keyword">end</span>),
    #<span class="org-type">panel</span> { id=placeholder }.

<span class="org-function-name">counter</span>(<span class="org-variable-name">Count</span>) -&gt;
    <span class="org-type">timer</span>:<span class="org-type">sleep</span>(1000),
    <span class="org-type">wf</span>:<span class="org-type">update</span>(placeholder, <span class="org-builtin">integer_to_list</span>(<span class="org-variable-name">Count</span>)),
    <span class="org-type">wf</span>:<span class="org-type">flush</span>(),
    <span class="org-type">counter</span>(<span class="org-variable-name">Count</span> + 1).
</pre>


</div>
</div>
</div>

</div>

<div id="outline-container-68" class="outline-2">
<h2 id="sec-68"><span class="section-number-2">68</span> Comet Pools</h2>
<div class="outline-text-2" id="text-68">


</div>

<div id="outline-container-68-1" class="outline-3">
<h3 id="sec-68-1"><span class="section-number-3">68.1</span> Comet</h3>
<div class="outline-text-3" id="text-68-1">


</div>

<div id="outline-container-68-1-1" class="outline-4">
<h4 id="sec-68-1-1"><span class="section-number-4">68.1.1</span> Comet Pools</h4>
<div class="outline-text-4" id="text-68-1-1">


<p>
    You can tell a Comet function to start in a pool by providing a
    <code>PoolName</code>. The <code>PoolName</code> can be any Erlang term.
</p>



<pre class="src src-erlang"><span class="org-type">wf</span>:<span class="org-type">comet</span>(<span class="org-variable-name">Fun</span>, <span class="org-variable-name">PoolName</span>)
</pre>


<p>
    Now you can send messages to the pool. The messages will be
    received by other functions started in that comet pool.
</p>



<pre class="src src-erlang"><span class="org-type">wf</span>:<span class="org-type">send</span>(<span class="org-variable-name">PoolName</span>, <span class="org-variable-name">Message</span>)
</pre>


</div>
</div>
</div>

</div>

<div id="outline-container-69" class="outline-2">
<h2 id="sec-69"><span class="section-number-2">69</span> Comet Pool Scope</h2>
<div class="outline-text-2" id="text-69">


</div>

<div id="outline-container-69-1" class="outline-3">
<h3 id="sec-69-1"><span class="section-number-3">69.1</span> Comet</h3>
<div class="outline-text-3" id="text-69-1">


</div>

<div id="outline-container-69-1-1" class="outline-4">
<h4 id="sec-69-1-1"><span class="section-number-4">69.1.1</span> Comet Pool Scope</h4>
<div class="outline-text-4" id="text-69-1-1">


<p>
    So far, we've been creating <b>local</b> comet pools. Nitrogen also has
    the idea of <b>global</b> comet pools:
</p>
<ul>
<li><b>Local</b> comet pools are walled around the current page and the
      current user. If the user reloads the page, the comet process(es)
      goes away.

</li>
<li><b>Global</b> comet pools exist to help you create multi-user
      applications. They pool is accessible by <b>all</b> pages and <b>all</b>
      users.
</li>
</ul>





<pre class="src src-erlang"><span class="org-comment-delimiter">%% </span><span class="org-comment">Create a global comet pool.</span>
<span class="org-type">wf</span>:<span class="org-type">comet_global</span>(<span class="org-variable-name">Function</span>, <span class="org-variable-name">PoolName</span>)

<span class="org-comment-delimiter">%% </span><span class="org-comment">Send a global comet message.</span>
<span class="org-type">wf</span>:<span class="org-type">send_global</span>(<span class="org-variable-name">PoolName</span>, <span class="org-variable-name">Message</span>)
</pre>


</div>
</div>
</div>

</div>

<div id="outline-container-70" class="outline-2">
<h2 id="sec-70"><span class="section-number-2">70</span> The Simplest Chatroom Ever Constructed</h2>
<div class="outline-text-2" id="text-70">


</div>

<div id="outline-container-70-1" class="outline-3">
<h3 id="sec-70-1"><span class="section-number-3">70.1</span> Comet</h3>
<div class="outline-text-3" id="text-70-1">


</div>

<div id="outline-container-70-1-1" class="outline-4">
<h4 id="sec-70-1-1"><span class="section-number-4">70.1.1</span> The Simplest Chatroom Ever Constructed</h4>
<div class="outline-text-4" id="text-70-1-1">


<p>
    Here we're going to create a page that listens for some text, and
    sends it to the global comet pool. Connect with different browsers
    and chat to yourself.
</p>



<pre class="src src-erlang"><span class="org-function-name">body</span>() -&gt;<span class="org-function-name"> </span>
    <span class="org-type">wf</span>:<span class="org-type">comet_global</span>(<span class="org-keyword">fun</span>() -&gt;<span class="org-function-name"> </span><span class="org-type">repeater</span>() <span class="org-keyword">end</span>, repeater_pool),
    [
        #<span class="org-type">textbox</span> { id=msg, text=<span class="org-string">"Your message..."</span>, next=submit },
        #<span class="org-type">button</span> { id=submit, text=<span class="org-string">"Submit"</span>, postback=submit },
        #<span class="org-type">panel</span> { id=placeholder }
    ].

<span class="org-function-name">event</span>(submit) -&gt;
    ?<span class="org-constant">PRINT</span>(<span class="org-type">wf</span>:<span class="org-type">q</span>(msg)),
    <span class="org-type">wf</span>:<span class="org-type">send_global</span>(repeater_pool, {msg, <span class="org-type">wf</span>:<span class="org-type">q</span>(msg)}).

<span class="org-function-name">repeater</span>() -&gt;
    <span class="org-keyword">receive</span> 
        {msg, <span class="org-variable-name">Msg</span>} -&gt;<span class="org-function-name"> </span><span class="org-type">wf</span>:<span class="org-type">insert_top</span>(placeholder, [<span class="org-variable-name">Msg</span>, <span class="org-string">"&lt;br&gt;"</span>])
    <span class="org-keyword">end</span>,
    <span class="org-type">wf</span>:<span class="org-type">flush</span>(),
    <span class="org-type">repeater</span>().
</pre>


</div>
</div>
</div>

</div>

<div id="outline-container-71" class="outline-2">
<h2 id="sec-71"><span class="section-number-2">71</span> PART 10 AGENDA</h2>
<div class="outline-text-2" id="text-71">


</div>

<div id="outline-container-71-1" class="outline-3">
<h3 id="sec-71-1"><span class="section-number-3">71.1</span> Extending Nitrogen</h3>
<div class="outline-text-3" id="text-71-1">

<ul>
<li>Custom Elements
</li>
<li>Custom Actions
</li>
<li>Handlers
</li>
</ul>

</div>
</div>

</div>

<div id="outline-container-72" class="outline-2">
<h2 id="sec-72"><span class="section-number-2">72</span> Custom Elements - Part 1</h2>
<div class="outline-text-2" id="text-72">


</div>

<div id="outline-container-72-1" class="outline-3">
<h3 id="sec-72-1"><span class="section-number-3">72.1</span> Extending Nitrogen</h3>
<div class="outline-text-3" id="text-72-1">


</div>

<div id="outline-container-72-1-1" class="outline-4">
<h4 id="sec-72-1-1"><span class="section-number-4">72.1.1</span> Custom Elements - Part 1</h4>
<div class="outline-text-4" id="text-72-1-1">


<p>    
    You can create custom elements to encapsulate other
    elements. There is no difference between a <b>custom</b> element and a
    <b>built-in</b> element, except where the actual files are stored.
</p>
<p>
    Create a new custom element in <code>site/src/elements/my_element.erl</code>.
</p>
<pre class="example">
./bin/dev element my_element
</pre>


</div>
</div>
</div>

</div>

<div id="outline-container-73" class="outline-2">
<h2 id="sec-73"><span class="section-number-2">73</span> Custom Elements - Part 2</h2>
<div class="outline-text-2" id="text-73">


</div>

<div id="outline-container-73-1" class="outline-3">
<h3 id="sec-73-1"><span class="section-number-3">73.1</span> Extending Nitrogen</h3>
<div class="outline-text-3" id="text-73-1">


</div>

<div id="outline-container-73-1-1" class="outline-4">
<h4 id="sec-73-1-1"><span class="section-number-4">73.1.1</span> Custom Elements - Part 2</h4>
<div class="outline-text-4" id="text-73-1-1">


<p>    
    An element has:
</p>
<ol>
<li>A <b>record</b> containing the properties of the element.

</li>
<li>A <code>reflect()</code> function, providing a programattic way to get the
       properties of an element. If <code>record_info(fields, RecordType)</code>
       worked, this would not be necessary.)

</li>
<li>A <code>render_element(Record)</code> function that emits HTML or
       other elements.
</li>
</ol>


</div>
</div>
</div>

</div>

<div id="outline-container-74" class="outline-2">
<h2 id="sec-74"><span class="section-number-2">74</span> Custom Elements - Part 3</h2>
<div class="outline-text-2" id="text-74">


</div>

<div id="outline-container-74-1" class="outline-3">
<h3 id="sec-74-1"><span class="section-number-3">74.1</span> Extending Nitrogen</h3>
<div class="outline-text-3" id="text-74-1">


</div>

<div id="outline-container-74-1-1" class="outline-4">
<h4 id="sec-74-1-1"><span class="section-number-4">74.1.1</span> Custom Elements - Part 3</h4>
<div class="outline-text-4" id="text-74-1-1">


<p>    
    Let's make an element that displays a textbox and a button, logs
    the result of the textbox to the console, and then calls a method
    on the main page.
</p>



<pre class="src src-erlang"><span class="org-function-name">render_element</span>(#<span class="org-type">my_element</span>{}) -&gt;
    <span class="org-variable-name">TextboxID</span> = <span class="org-type">wf</span>:<span class="org-type">temp_id</span>(),
    <span class="org-variable-name">ButtonID</span> = <span class="org-type">wf</span>:<span class="org-type">temp_id</span>(),
    <span class="org-type">wf</span>:<span class="org-type">wire</span>(<span class="org-variable-name">ButtonID</span>, #<span class="org-type">event</span> { 
        type=click,
        delegate=?<span class="org-constant">MODULE</span>, 
        postback={click, <span class="org-variable-name">TextboxID</span>}
    }),
    [
        #<span class="org-type">textbox</span> { id=<span class="org-variable-name">TextboxID</span>, text=<span class="org-string">"Your text..."</span>, next=<span class="org-variable-name">ButtonID</span> },
        #<span class="org-type">button</span> { id=<span class="org-variable-name">ButtonID</span>, text=<span class="org-string">"Submit"</span> }
    ].

<span class="org-function-name">event</span>({click, <span class="org-variable-name">TextboxID</span>}) -&gt;
    <span class="org-variable-name">Text</span> = <span class="org-type">wf</span>:<span class="org-type">q</span>(<span class="org-variable-name">TextboxID</span>),
    ?<span class="org-constant">PRINT</span>({clicked, <span class="org-variable-name">TextboxID</span>, <span class="org-variable-name">Text</span>}),
    <span class="org-variable-name">PageModule</span> = <span class="org-type">wf</span>:<span class="org-type">page_module</span>(),
    <span class="org-variable-name">PageModule</span>:<span class="org-type">my_element_event</span>(<span class="org-variable-name">Text</span>).
</pre>

</div>
</div>
</div>

</div>

<div id="outline-container-75" class="outline-2">
<h2 id="sec-75"><span class="section-number-2">75</span> Custom Elements - Part 4</h2>
<div class="outline-text-2" id="text-75">


</div>

<div id="outline-container-75-1" class="outline-3">
<h3 id="sec-75-1"><span class="section-number-3">75.1</span> Extending Nitrogen</h3>
<div class="outline-text-3" id="text-75-1">


</div>

<div id="outline-container-75-1-1" class="outline-4">
<h4 id="sec-75-1-1"><span class="section-number-4">75.1.1</span> Custom Elements - Part 4</h4>
<div class="outline-text-4" id="text-75-1-1">


<p>
    Now, use the element on <code>my_page.erl</code>. Remember to move the
    element into <code>include/records.hrl</code> first!
</p>



<pre class="src src-erlang"><span class="org-function-name">body</span>() -&gt;<span class="org-function-name"> </span>
    #<span class="org-type">my_element</span> {}.

<span class="org-function-name">my_element_event</span>(<span class="org-variable-name">Text</span>) -&gt;
    ?<span class="org-constant">PRINT</span>(<span class="org-variable-name">Text</span>).
</pre>



<p>
    <i>For more examples, see the built-in elements under     nitrogen<sub>core</sub>/src/elements.</i>
</p>
</div>
</div>
</div>

</div>

<div id="outline-container-76" class="outline-2">
<h2 id="sec-76"><span class="section-number-2">76</span> Custom Actions - Part 1</h2>
<div class="outline-text-2" id="text-76">


</div>

<div id="outline-container-76-1" class="outline-3">
<h3 id="sec-76-1"><span class="section-number-3">76.1</span> Extending Nitrogen</h3>
<div class="outline-text-3" id="text-76-1">


</div>

<div id="outline-container-76-1-1" class="outline-4">
<h4 id="sec-76-1-1"><span class="section-number-4">76.1.1</span> Custom Actions - Part 1</h4>
<div class="outline-text-4" id="text-76-1-1">


<p>
    A custom <b>action</b> is like a custom <b>element</b>, except it should
    emit Javascript or other actions.
</p>
<pre class="example">
./bin/dev action my_action
</pre>


</div>
</div>
</div>

</div>

<div id="outline-container-77" class="outline-2">
<h2 id="sec-77"><span class="section-number-2">77</span> Custom Actions - Part 2</h2>
<div class="outline-text-2" id="text-77">


</div>

<div id="outline-container-77-1" class="outline-3">
<h3 id="sec-77-1"><span class="section-number-3">77.1</span> Extending Nitrogen</h3>
<div class="outline-text-3" id="text-77-1">


</div>

<div id="outline-container-77-1-1" class="outline-4">
<h4 id="sec-77-1-1"><span class="section-number-4">77.1.1</span> Custom Actions - Part 2</h4>
<div class="outline-text-4" id="text-77-1-1">


<p>
    Let's make a custom action that calls <code>#alert{}</code> with a specified
    string, but converted to all uppercase.
</p>



<pre class="src src-erlang"><span class="org-preprocessor">-record</span>(<span class="org-type">my_action</span>, {?<span class="org-constant">ACTION_BASE</span>(action_my_action), text}).

<span class="org-function-name">render_action</span>(<span class="org-variable-name">Record</span> = #<span class="org-type">my_action</span>{}) -&gt;
    #<span class="org-type">alert</span> { text=<span class="org-type">string</span>:<span class="org-type">to_upper</span>(<span class="org-variable-name">Record</span>#<span class="org-type">my_action</span>.text) }.
</pre>

</div>
</div>
</div>

</div>

<div id="outline-container-78" class="outline-2">
<h2 id="sec-78"><span class="section-number-2">78</span> Custom Actions - Part 3</h2>
<div class="outline-text-2" id="text-78">


</div>

<div id="outline-container-78-1" class="outline-3">
<h3 id="sec-78-1"><span class="section-number-3">78.1</span> Extending Nitrogen</h3>
<div class="outline-text-3" id="text-78-1">


</div>

<div id="outline-container-78-1-1" class="outline-4">
<h4 id="sec-78-1-1"><span class="section-number-4">78.1.1</span> Custom Actions - Part 3</h4>
<div class="outline-text-4" id="text-78-1-1">


<p>
    Now, use the element on <code>my_page.erl</code>. Remember to move the action
    into <code>include/records.hrl</code> first!
</p>



<pre class="src src-erlang"><span class="org-function-name">body</span>() -&gt;<span class="org-function-name"> </span>
    <span class="org-type">wf</span>:<span class="org-type">wire</span>(#<span class="org-type">my_action</span> { text=<span class="org-string">"this is a message"</span> }),
    #<span class="org-type">label</span> { text=<span class="org-string">"You should see an alert."</span> }.
</pre>


<p>
    <i>For more examples, see the built-in actions under     nitrogen<sub>core</sub>/src/actions.</i>
</p>
</div>
</div>
</div>

</div>

<div id="outline-container-79" class="outline-2">
<h2 id="sec-79"><span class="section-number-2">79</span> Handlers - Part 1</h2>
<div class="outline-text-2" id="text-79">


</div>

<div id="outline-container-79-1" class="outline-3">
<h3 id="sec-79-1"><span class="section-number-3">79.1</span> Extending Nitrogen</h3>
<div class="outline-text-3" id="text-79-1">


</div>

<div id="outline-container-79-1-1" class="outline-4">
<h4 id="sec-79-1-1"><span class="section-number-4">79.1.1</span> Handlers - Part 1</h4>
<div class="outline-text-4" id="text-79-1-1">


<p>
    Handlers are an attempt to formalize an approach for overriding
    core Nitrogen behavior.
</p>
<p>
    Handlers exist for:
</p><ul>
<li>Configuration
</li>
<li>Logging
</li>
<li>Process Registry
</li>
<li>Caching
</li>
<li>Session Storage
</li>
<li>Page State Storage
</li>
<li>User Identity
</li>
<li>Roles
</li>
<li>Routing
</li>
<li>Security
</li>
</ul>


</div>
</div>
</div>

</div>

<div id="outline-container-80" class="outline-2">
<h2 id="sec-80"><span class="section-number-2">80</span> Handlers - Part 2</h2>
<div class="outline-text-2" id="text-80">


</div>

<div id="outline-container-80-1" class="outline-3">
<h3 id="sec-80-1"><span class="section-number-3">80.1</span> Extending Nitrogen</h3>
<div class="outline-text-3" id="text-80-1">


</div>

<div id="outline-container-80-1-1" class="outline-4">
<h4 id="sec-80-1-1"><span class="section-number-4">80.1.1</span> Handlers - Part 2</h4>
<div class="outline-text-4" id="text-80-1-1">


<p>    
    Handlers are initialized in the order described on the previous
    page. This means that any handler can access and override
    information defined by a handler that came before it. 
</p>
<p>
    For example, you could write a <code>route_handler</code> that behaved
    differently depending on the role of a user.
</p></div>
</div>
</div>

</div>

<div id="outline-container-81" class="outline-2">
<h2 id="sec-81"><span class="section-number-2">81</span> Handlers - Part 3</h2>
<div class="outline-text-2" id="text-81">


</div>

<div id="outline-container-81-1" class="outline-3">
<h3 id="sec-81-1"><span class="section-number-3">81.1</span> Extending Nitrogen</h3>
<div class="outline-text-3" id="text-81-1">


</div>

<div id="outline-container-81-1-1" class="outline-4">
<h4 id="sec-81-1-1"><span class="section-number-4">81.1.1</span> Handlers - Part 3</h4>
<div class="outline-text-4" id="text-81-1-1">


<p>
    Let's make a <code>security_handler</code> handler that only allows the user
    to access modules beginning with the word "my".
</p>



<pre class="src src-erlang"><span class="org-preprocessor">-module</span>(my_security_handler).
<span class="org-preprocessor">-behaviour</span>(security_handler).
<span class="org-preprocessor">-export</span>([<span class="org-type">init/2</span>, <span class="org-type">finish/2</span>]).
<span class="org-preprocessor">-include_lib</span>(<span class="org-string">"nitrogen_core/include/wf.hrl"</span>).

<span class="org-function-name">init</span>(<span class="org-variable-name">_Config</span>, <span class="org-variable-name">State</span>) -&gt;
    ?<span class="org-constant">PRINT</span>(<span class="org-type">wf</span>:<span class="org-type">page_module</span>()),
    <span class="org-keyword">case</span> <span class="org-type">wf</span>:<span class="org-type">to_list</span>(<span class="org-type">wf</span>:<span class="org-type">page_module</span>()) <span class="org-keyword">of</span>
        <span class="org-string">"my"</span> ++ <span class="org-variable-name">_</span> -&gt;
            {ok, <span class="org-variable-name">State</span>};
        <span class="org-string">"static_file"</span> -&gt;
            {ok, <span class="org-variable-name">State</span>};
        <span class="org-variable-name">_</span> -&gt;
            <span class="org-type">wf_context</span>:<span class="org-type">page_module</span>(access_denied),
            {ok, <span class="org-variable-name">State</span>}
    <span class="org-keyword">end</span>.

<span class="org-function-name">finish</span>(<span class="org-variable-name">_Config</span>, <span class="org-variable-name">State</span>) -&gt;
    {ok, <span class="org-variable-name">State</span>}.
</pre>


</div>
</div>
</div>

</div>

<div id="outline-container-82" class="outline-2">
<h2 id="sec-82"><span class="section-number-2">82</span> Handlers - Part 3</h2>
<div class="outline-text-2" id="text-82">


</div>

<div id="outline-container-82-1" class="outline-3">
<h3 id="sec-82-1"><span class="section-number-3">82.1</span> Extending Nitrogen</h3>
<div class="outline-text-3" id="text-82-1">


</div>

<div id="outline-container-82-1-1" class="outline-4">
<h4 id="sec-82-1-1"><span class="section-number-4">82.1.1</span> Handlers - Part 3</h4>
<div class="outline-text-4" id="text-82-1-1">


<p>
    Now, install the handler in <code>nitrogen_inets.erl</code>:
</p>



<pre class="src src-erlang"><span class="org-function-name">do</span>(<span class="org-variable-name">Info</span>) -&gt;
    <span class="org-variable-name">RequestBridge</span> = <span class="org-type">simple_bridge</span>:<span class="org-type">make_request</span>(inets_request_bridge, <span class="org-variable-name">Info</span>),
    <span class="org-variable-name">ResponseBridge</span> = <span class="org-type">simple_bridge</span>:<span class="org-type">make_response</span>(inets_response_bridge, <span class="org-variable-name">Info</span>),
    <span class="org-type">nitrogen</span>:<span class="org-type">init_request</span>(<span class="org-variable-name">RequestBridge</span>, <span class="org-variable-name">ResponseBridge</span>),
    <span class="org-type">nitrogen</span>:<span class="org-type">handler</span>(my_security_handler, []),
    <span class="org-type">nitrogen</span>:<span class="org-type">run</span>().
</pre>


</div>
</div>
</div>

</div>

<div id="outline-container-83" class="outline-2">
<h2 id="sec-83"><span class="section-number-2">83</span> Conclusion</h2>
<div class="outline-text-2" id="text-83">


</div>

<div id="outline-container-83-1" class="outline-3">
<h3 id="sec-83-1"><span class="section-number-3">83.1</span> Conclusion</h3>
<div class="outline-text-3" id="text-83-1">

<p>  By now, you should have a basic understanding of how Nitrogen works,
  and know enough to be able to quickly grok the examples on
  <a href="http://nitrogenproject.com">http://nitrogenproject.com</a> and apply them to your own pages.
</p>
<p>  
  Things not covered in this tutorial:
</p>
<ul>
<li>Drag and Drop
</li>
<li>Sorting
</li>
<li>Binding
</li>
<li>More Effects
</li>
<li>File Uploads
</li>
<li>Javascript API
</li>
<li>Custom Valiators
</li>
<li>Handlers
</li>
</ul>


</div>
</div>

</div>

<div id="outline-container-84" class="outline-2">
<h2 id="sec-84"><span class="section-number-2">84</span> Conclusion</h2>
<div class="outline-text-2" id="text-84">


</div>

<div id="outline-container-84-1" class="outline-3">
<h3 id="sec-84-1"><span class="section-number-3">84.1</span> Thanks</h3>
<div class="outline-text-3" id="text-84-1">


<ul>
<li>Mailing List, Bugs, etc: <a href="http://nitrogenproject.com/community">http://nitrogenproject.com/community</a>
</li>
<li>Follow Nitrogen on Twitter: <a href="http://twitter.com/nitrogenproject">@nitrogenproject</a>
</li>
<li>Follow Rusty on Twitter: <a href="http://twitter.com/rustyio">@rustyio</a>
</li>
<li>Follow Jesse on Twitter: <a href="http://twitter.com/jessegumm">@jessegumm</a>
</li>
</ul>

</div>
</div>
</div>
</div>

<div id="postamble">
<p class="date">Date: 2012-10-18 03:24:02 CDT</p>
<p class="author">Author: Jesse Gumm</p>
<p class="creator">Org version 7.8.02 with Emacs version 23</p>
<a href="http://validator.w3.org/check?uri=referer">Validate XHTML 1.0</a>

</div><h2>Comments</h2>
<b>Note:</b><!-- Disqus does not currently support Erlang for its syntax highlighting, so t-->To specify <!--Erlang--> code blocks, just use the generic code block syntax: <pre><b>&lt;pre&gt;&lt;code&gt;your code here&lt;/code&gt;&lt;/pre&gt;</b></pre>
<br />
<br />
<div id="disqus_thread"></div>
<script type="text/javascript">
	/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
	var disqus_shortname = 'nitrogenproject'; // required: replace example with your forum shortname
	var disqus_identifier = 'html/tutorial.html'; //This will be replaced with the path part of the url

	/* * * DON'T EDIT BELOW THIS LINE * * */
	(function() {
		var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
		dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
		(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
	})();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</body>
</html>
